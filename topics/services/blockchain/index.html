
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../blockValidation/">
      
      
        <link rel="next" href="../propagation/">
      
      
      <link rel="icon" href="../../architecture/img/bsvblockchain_blue_logo.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Blockchain - Teranode</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.84d31ad4.min.css">
      
      


    
    
      
    
    
      
        
        
        
        <link rel="stylesheet" href="../../../assets/external/fonts.googleapis.com/css.49ea35f2.css">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../overrides/custom.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#blockchain-service" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Teranode" class="md-header__button md-logo" aria-label="Teranode" data-md-component="logo">
      
  <img src="../../architecture/img/bsvblockchain_logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Teranode
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Blockchain
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../tutorials/developers/forkAndPullRequestGuidelines/" class="md-tabs__link">
          
  
  
  Tutorials

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../howto/locallyRunningServices/" class="md-tabs__link">
          
  
  
  How-To Guides

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../teranodeIntro/" class="md-tabs__link">
          
  
  
  Key Topics

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../references/projectStructure/" class="md-tabs__link">
          
  
  
  Reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Teranode" class="md-nav__button md-logo" aria-label="Teranode" data-md-component="logo">
      
  <img src="../../architecture/img/bsvblockchain_logo.svg" alt="logo">

    </a>
    Teranode
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tutorials
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/developers/forkAndPullRequestGuidelines/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fork and Pull Request Guidelines
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/developers/developerSetup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Developer Setup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/miners/minersGettingStarted/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Miners Getting Started
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    How-To Guides
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            How-To Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/locallyRunningServices/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Running Services Locally
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/howToRemoteDebugTeranode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Debugging Teranode
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/generatingProtobuf/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generating Protobuf
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/addingNewProtobufServices/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Adding Protobuf
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/configuringGrpcLogging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuring gRPC Logging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/runningTests/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Running Tests
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/automatedTestingHowTo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Automated Testing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/chain-integrity-testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chain Integrity Testing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/makefile/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Makefile Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/bugReporting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bug Reporting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/developersHowToTeranodeCLI/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Developer's Guide to Teranode-CLI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_12" >
        
          
          <label class="md-nav__link" for="__nav_3_12" id="__nav_3_12_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Miners
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_12">
            <span class="md-nav__icon md-icon"></span>
            Miners
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_12_1" >
        
          
          <label class="md-nav__link" for="__nav_3_12_1" id="__nav_3_12_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_12_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_12_1">
            <span class="md-nav__icon md-icon"></span>
            Installation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/docker/minersHowToInstallation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Docker
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/kubernetes/minersHowToInstallation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kubernetes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/kubernetes/minersHowToInstallationDeprecated/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deprecated
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_12_2" >
        
          
          <label class="md-nav__link" for="__nav_3_12_2" id="__nav_3_12_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Configuration
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_12_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_12_2">
            <span class="md-nav__icon md-icon"></span>
            Configuration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/docker/minersHowToConfigureTheNode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Docker
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/kubernetes/minersHowToConfigureTheNode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kubernetes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/minersHowToAerospikeTuning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Aerospike Tuning
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/minersHowToInteractWithAssetServer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Asset Server Interaction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/minersHowToInteractWithFSM/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FSM Interaction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/minersHowToInteractWithRPCServer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RPC Server Interaction
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_12_3" >
        
          
          <label class="md-nav__link" for="__nav_3_12_3" id="__nav_3_12_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Start/Stop
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_12_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_12_3">
            <span class="md-nav__icon md-icon"></span>
            Start/Stop
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/docker/minersHowToStopStartDockerTeranode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Docker
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/kubernetes/minersHowToStopStartKubernetesTeranode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kubernetes
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_12_4" >
        
          
          <label class="md-nav__link" for="__nav_3_12_4" id="__nav_3_12_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Updating Teranode
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_12_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_12_4">
            <span class="md-nav__icon md-icon"></span>
            Updating Teranode
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/docker/minersUpdatingTeranode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Docker
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/kubernetes/minersUpdatingTeranode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kubernetes
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_12_5" >
        
          
          <label class="md-nav__link" for="__nav_3_12_5" id="__nav_3_12_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Security Best Practices
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_12_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_12_5">
            <span class="md-nav__icon md-icon"></span>
            Security Best Practices
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/docker/minersSecurityBestPractices/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Docker
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/kubernetes/minersSecurityBestPractices/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kubernetes
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_12_6" >
        
          
          <label class="md-nav__link" for="__nav_3_12_6" id="__nav_3_12_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Troubleshooting
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_12_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_12_6">
            <span class="md-nav__icon md-icon"></span>
            Troubleshooting
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/docker/minersHowToTroubleshooting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Docker
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/kubernetes/minersHowToTroubleshooting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kubernetes
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_12_7" >
        
          
          <label class="md-nav__link" for="__nav_3_12_7" id="__nav_3_12_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Additional
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_12_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_12_7">
            <span class="md-nav__icon md-icon"></span>
            Additional
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/minersHowToCPUMiner/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CPU Mining Setup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/minersHowToResetTeranode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Reset Teranode
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/minersHowToSyncTheNode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sync the Node
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/minersHowToTeranodeCLI/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Teranode CLI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/minersManagingDiskSpace/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Managing Disk Space
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/minersHowToUseListenMode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Using Listen Mode
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/miners/kubernetes/minersHowToBackup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Backup (Kubernetes)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Key Topics
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Key Topics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../teranodeIntro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Teranode Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/teranode-overall-system-design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Architecture Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/teranode-architecture-brief/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Architecture Brief
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/teranode-microservices-overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Microservices Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../transactionLifecycle/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Transaction Lifecycle
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/stateManagement/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    State Management
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../state-machine.diagram/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    State Machine Diagram
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/understandingDoubleSpends/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Understanding Double Spends
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../technologyStack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Technology Stack
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../understandingTheTestingFramework/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Understanding the Testing Framework
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../functionalRequirementTests/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Functional Requirement Tests
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_12" >
        
          
          <label class="md-nav__link" for="__nav_4_12" id="__nav_4_12_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Features
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_12">
            <span class="md-nav__icon md-icon"></span>
            Features
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../features/two_phase_commit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Two Phase Commit
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_13" checked>
        
          
          <label class="md-nav__link" for="__nav_4_13" id="__nav_4_13_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Core Services
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_13_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_13">
            <span class="md-nav__icon md-icon"></span>
            Core Services
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../alert/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Alert Service
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../assetServer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Asset Server
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../blockAssembly/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Block Assembly
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../blockValidation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Block Validation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Blockchain
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Blockchain
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#index" class="md-nav__link">
    <span class="md-ellipsis">
      Index
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-description" class="md-nav__link">
    <span class="md-ellipsis">
      1. Description
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-functionality" class="md-nav__link">
    <span class="md-ellipsis">
      2. Functionality
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Functionality">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-service-initialization" class="md-nav__link">
    <span class="md-ellipsis">
      2.1. Service initialization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-adding-a-new-block-to-the-blockchain" class="md-nav__link">
    <span class="md-ellipsis">
      2.2. Adding a new block to the blockchain
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-sending-new-block-notifications-to-the-block-persister" class="md-nav__link">
    <span class="md-ellipsis">
      2.3. Sending new block notifications to the Block Persister
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-getting-a-block-from-the-blockchain" class="md-nav__link">
    <span class="md-ellipsis">
      2.4. Getting a block from the blockchain
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#25-getting-the-last-n-blocks-from-the-blockchain" class="md-nav__link">
    <span class="md-ellipsis">
      2.5. Getting the last N blocks from the blockchain
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#26-checking-if-a-block-exists-in-the-blockchain" class="md-nav__link">
    <span class="md-ellipsis">
      2.6. Checking if a Block Exists in the Blockchain
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#27-getting-the-best-block-header" class="md-nav__link">
    <span class="md-ellipsis">
      2.7. Getting the Best Block Header
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#28-getting-the-block-headers" class="md-nav__link">
    <span class="md-ellipsis">
      2.8. Getting the Block Headers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#29-invalidating-a-block" class="md-nav__link">
    <span class="md-ellipsis">
      2.9. Invalidating a Block
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#210-subscribing-to-blockchain-events" class="md-nav__link">
    <span class="md-ellipsis">
      2.10. Subscribing to Blockchain Events
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#211-triggering-a-subscription-notification" class="md-nav__link">
    <span class="md-ellipsis">
      2.11. Triggering a Subscription Notification
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-grpc-protobuf-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      3. gRPC Protobuf Definitions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-data-model" class="md-nav__link">
    <span class="md-ellipsis">
      4. Data Model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-technology" class="md-nav__link">
    <span class="md-ellipsis">
      5. Technology
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-directory-structure-and-main-files" class="md-nav__link">
    <span class="md-ellipsis">
      6. Directory Structure and Main Files
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-how-to-run" class="md-nav__link">
    <span class="md-ellipsis">
      7. How to run
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      8. Configuration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-additional-technical-details" class="md-nav__link">
    <span class="md-ellipsis">
      9. Additional Technical Details
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9. Additional Technical Details">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#91-complete-grpc-method-coverage" class="md-nav__link">
    <span class="md-ellipsis">
      9.1. Complete gRPC Method Coverage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9.1. Complete gRPC Method Coverage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fsm-management-methods" class="md-nav__link">
    <span class="md-ellipsis">
      FSM Management Methods
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#state-management" class="md-nav__link">
    <span class="md-ellipsis">
      State Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#block-mining-status-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Block Mining Status Methods
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#legacy-synchronization-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Legacy Synchronization Methods
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#92-finite-state-machine-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      9.2. Finite State Machine Implementation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#93-kafka-integration-details" class="md-nav__link">
    <span class="md-ellipsis">
      9.3. Kafka Integration Details
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9.3. Kafka Integration Details">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#message-formats" class="md-nav__link">
    <span class="md-ellipsis">
      Message Formats
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#topics" class="md-nav__link">
    <span class="md-ellipsis">
      Topics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-handling" class="md-nav__link">
    <span class="md-ellipsis">
      Error Handling
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#94-error-handling-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      9.4. Error Handling Strategies
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9.4. Error Handling Strategies">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#network-and-communication-errors" class="md-nav__link">
    <span class="md-ellipsis">
      Network and Communication Errors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validation-errors" class="md-nav__link">
    <span class="md-ellipsis">
      Validation Errors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chain-reorganization-and-longest-chain-tracking" class="md-nav__link">
    <span class="md-ellipsis">
      Chain Reorganization and Longest Chain Tracking
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Chain Reorganization and Longest Chain Tracking">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#automatic-detection" class="md-nav__link">
    <span class="md-ellipsis">
      Automatic Detection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optimized-longest-chain-selection" class="md-nav__link">
    <span class="md-ellipsis">
      Optimized Longest Chain Selection
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#storage-errors" class="md-nav__link">
    <span class="md-ellipsis">
      Storage Errors
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10-other-resources" class="md-nav__link">
    <span class="md-ellipsis">
      10. Other Resources
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../propagation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Propagation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../subtreeValidation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Subtree Validation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../validator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Validator
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_14" >
        
          
          <label class="md-nav__link" for="__nav_4_14" id="__nav_4_14_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Overlay Services
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_14">
            <span class="md-nav__icon md-icon"></span>
            Overlay Services
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../blockPersister/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Block Persister
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../p2p/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    P2P
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../P2P_NAT_TRAVERSAL/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    P2P NAT Traversal
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../legacy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Legacy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rpc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RPC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utxoPersister/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    UTXO Persister
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_15" >
        
          
          <label class="md-nav__link" for="__nav_4_15" id="__nav_4_15_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Stores
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_15">
            <span class="md-nav__icon md-icon"></span>
            Stores
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stores/blob/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Blob Store
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stores/utxo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    UTXO Store
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_16" >
        
          
          <label class="md-nav__link" for="__nav_4_16" id="__nav_4_16_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Data Model
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_16_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_16">
            <span class="md-nav__icon md-icon"></span>
            Data Model
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../datamodel/block_data_model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Block Data Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../datamodel/block_header_data_model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Block Header Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../datamodel/subtree_data_model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Subtree Data Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../datamodel/transaction_data_model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Transaction Data Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../datamodel/utxo_data_model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    UTXO Data Model
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_17" >
        
          
          <label class="md-nav__link" for="__nav_4_17" id="__nav_4_17_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Kafka
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_17_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_17">
            <span class="md-nav__icon md-icon"></span>
            Kafka
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kafka/kafka/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kafka Overview
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_18" >
        
          
          <label class="md-nav__link" for="__nav_4_18" id="__nav_4_18_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Commands
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_18_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_18">
            <span class="md-nav__icon md-icon"></span>
            Commands
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../commands/seeder/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Seeder
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/projectStructure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Project Structure
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API & Protobuf
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            API & Protobuf
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/errorHandling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Error Handling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/glossary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Glossary
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/codingConventions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Coding Conventions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/kafkaMessageFormat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kafka Message Format
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/networkConsensusRules/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Network Consensus Rules
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_2_6" >
        
          
          <label class="md-nav__link" for="__nav_5_2_6" id="__nav_5_2_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Protobuf API
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_6">
            <span class="md-nav__icon md-icon"></span>
            Protobuf API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/protobuf_docs/alertProto/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Alert Proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/protobuf_docs/blockassemblyProto/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Block Assembly Proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/protobuf_docs/blockchainProto/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Blockchain Proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/protobuf_docs/blockvalidationProto/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Block Validation Proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/protobuf_docs/propagationProto/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Propagation Proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/protobuf_docs/subtreevalidationProto/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Subtree Validation Proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/protobuf_docs/validatorProto/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Validator Proto
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Core Services
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            Core Services
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/services/alert_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Alert Service
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/services/asset_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Asset Service
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/services/blockassembly_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Block Assembly
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/services/blockvalidation_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Block Validation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/services/blockchain_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Blockchain
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/services/propagation_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Propagation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/services/subtreevalidation_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Subtree Validation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/services/validator_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Validator
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Overlay Services
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            Overlay Services
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/services/blockpersister_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Block Persister
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/services/p2p_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    P2P
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/services/legacy_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    P2P Legacy Service
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/services/rpc_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RPC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/services/utxopersister_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    UTXO Persister
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_5" >
        
          
          <label class="md-nav__link" for="__nav_5_5" id="__nav_5_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Stores
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_5">
            <span class="md-nav__icon md-icon"></span>
            Stores
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/stores/blob_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Blob Store
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/stores/utxo_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    UTXO Store
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_6" >
        
          
          <label class="md-nav__link" for="__nav_5_6" id="__nav_5_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Configuration
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6">
            <span class="md-nav__icon md-icon"></span>
            Configuration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Settings Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/settings_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Settings Reference
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/settings/kafka_settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kafka Settings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_6_4" >
        
          
          <label class="md-nav__link" for="__nav_5_6_4" id="__nav_5_6_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Service Settings
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_6_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6_4">
            <span class="md-nav__icon md-icon"></span>
            Service Settings
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/settings/services/alert_settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Alert
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/settings/services/asset_settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Asset Server
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/settings/services/blockassembly_settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Block Assembly
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/settings/services/blockchain_settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Blockchain
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/settings/services/blockpersister_settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Block Persister
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/settings/services/blockvalidation_settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Block Validation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/settings/services/legacy_settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Legacy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/settings/services/p2p_settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    P2P
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/settings/services/propagation_settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Propagation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/settings/services/rpc_settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RPC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/settings/services/subtreevalidation_settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Subtree Validation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/settings/services/utxopersister_settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    UTXO Persister
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/settings/services/validator_settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Validator
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_6_5" >
        
          
          <label class="md-nav__link" for="__nav_5_6_5" id="__nav_5_6_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Store Settings
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_6_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6_5">
            <span class="md-nav__icon md-icon"></span>
            Store Settings
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/settings/stores/blob_settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Blob Store
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/settings/stores/utxo_settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    UTXO Store
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_7" >
        
          
          <label class="md-nav__link" for="__nav_5_7" id="__nav_5_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Miscellaneous
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_7">
            <span class="md-nav__icon md-icon"></span>
            Miscellaneous
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../misc/BIP-239/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    BIP-239 (Transaction Extended Format)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/gitCommitSigningSetupGuide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Git Commit Signing Setup Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/licenseInformation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Licensing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/prometheusMetrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prometheus Metrics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/teranodeDaemonReference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Teranode Daemon Reference
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/testingTechnicalReference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Testing Technical Reference
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/thirdPartySoftwareRequirements/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Third-Party Software Requirements
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#index" class="md-nav__link">
    <span class="md-ellipsis">
      Index
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-description" class="md-nav__link">
    <span class="md-ellipsis">
      1. Description
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-functionality" class="md-nav__link">
    <span class="md-ellipsis">
      2. Functionality
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Functionality">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-service-initialization" class="md-nav__link">
    <span class="md-ellipsis">
      2.1. Service initialization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-adding-a-new-block-to-the-blockchain" class="md-nav__link">
    <span class="md-ellipsis">
      2.2. Adding a new block to the blockchain
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-sending-new-block-notifications-to-the-block-persister" class="md-nav__link">
    <span class="md-ellipsis">
      2.3. Sending new block notifications to the Block Persister
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-getting-a-block-from-the-blockchain" class="md-nav__link">
    <span class="md-ellipsis">
      2.4. Getting a block from the blockchain
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#25-getting-the-last-n-blocks-from-the-blockchain" class="md-nav__link">
    <span class="md-ellipsis">
      2.5. Getting the last N blocks from the blockchain
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#26-checking-if-a-block-exists-in-the-blockchain" class="md-nav__link">
    <span class="md-ellipsis">
      2.6. Checking if a Block Exists in the Blockchain
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#27-getting-the-best-block-header" class="md-nav__link">
    <span class="md-ellipsis">
      2.7. Getting the Best Block Header
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#28-getting-the-block-headers" class="md-nav__link">
    <span class="md-ellipsis">
      2.8. Getting the Block Headers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#29-invalidating-a-block" class="md-nav__link">
    <span class="md-ellipsis">
      2.9. Invalidating a Block
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#210-subscribing-to-blockchain-events" class="md-nav__link">
    <span class="md-ellipsis">
      2.10. Subscribing to Blockchain Events
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#211-triggering-a-subscription-notification" class="md-nav__link">
    <span class="md-ellipsis">
      2.11. Triggering a Subscription Notification
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-grpc-protobuf-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      3. gRPC Protobuf Definitions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-data-model" class="md-nav__link">
    <span class="md-ellipsis">
      4. Data Model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-technology" class="md-nav__link">
    <span class="md-ellipsis">
      5. Technology
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-directory-structure-and-main-files" class="md-nav__link">
    <span class="md-ellipsis">
      6. Directory Structure and Main Files
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-how-to-run" class="md-nav__link">
    <span class="md-ellipsis">
      7. How to run
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      8. Configuration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-additional-technical-details" class="md-nav__link">
    <span class="md-ellipsis">
      9. Additional Technical Details
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9. Additional Technical Details">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#91-complete-grpc-method-coverage" class="md-nav__link">
    <span class="md-ellipsis">
      9.1. Complete gRPC Method Coverage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9.1. Complete gRPC Method Coverage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fsm-management-methods" class="md-nav__link">
    <span class="md-ellipsis">
      FSM Management Methods
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#state-management" class="md-nav__link">
    <span class="md-ellipsis">
      State Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#block-mining-status-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Block Mining Status Methods
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#legacy-synchronization-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Legacy Synchronization Methods
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#92-finite-state-machine-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      9.2. Finite State Machine Implementation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#93-kafka-integration-details" class="md-nav__link">
    <span class="md-ellipsis">
      9.3. Kafka Integration Details
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9.3. Kafka Integration Details">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#message-formats" class="md-nav__link">
    <span class="md-ellipsis">
      Message Formats
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#topics" class="md-nav__link">
    <span class="md-ellipsis">
      Topics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-handling" class="md-nav__link">
    <span class="md-ellipsis">
      Error Handling
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#94-error-handling-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      9.4. Error Handling Strategies
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9.4. Error Handling Strategies">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#network-and-communication-errors" class="md-nav__link">
    <span class="md-ellipsis">
      Network and Communication Errors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validation-errors" class="md-nav__link">
    <span class="md-ellipsis">
      Validation Errors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chain-reorganization-and-longest-chain-tracking" class="md-nav__link">
    <span class="md-ellipsis">
      Chain Reorganization and Longest Chain Tracking
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Chain Reorganization and Longest Chain Tracking">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#automatic-detection" class="md-nav__link">
    <span class="md-ellipsis">
      Automatic Detection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optimized-longest-chain-selection" class="md-nav__link">
    <span class="md-ellipsis">
      Optimized Longest Chain Selection
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#storage-errors" class="md-nav__link">
    <span class="md-ellipsis">
      Storage Errors
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10-other-resources" class="md-nav__link">
    <span class="md-ellipsis">
      10. Other Resources
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="blockchain-service"> Blockchain Service</h1>
<h2 id="index">Index</h2>
<ol>
<li><a href="#1-description">Description</a></li>
<li><a href="#2-functionality">Functionality</a><ul>
<li><a href="#21-service-initialization">2.1. Service initialization</a></li>
<li><a href="#22-adding-a-new-block-to-the-blockchain">2.2. Adding a new block to the blockchain</a></li>
<li><a href="#23-sending-new-block-notifications-to-the-block-persister">2.3. Sending new block notifications to the Block Persister</a></li>
<li><a href="#24-getting-a-block-from-the-blockchain">2.4. Getting a block from the blockchain</a></li>
<li><a href="#25-getting-the-last-n-blocks-from-the-blockchain">2.5. Getting the last N blocks from the blockchain</a></li>
<li><a href="#26-checking-if-a-block-exists-in-the-blockchain">2.6. Checking if a Block Exists in the Blockchain</a></li>
<li><a href="#27-getting-the-best-block-header">2.7. Getting the Best Block Header</a></li>
<li><a href="#28-getting-the-block-headers">2.8. Getting the Block Headers</a></li>
<li><a href="#29-invalidating-a-block">2.9. Invalidating a Block</a></li>
<li><a href="#210-subscribing-to-blockchain-events">2.10. Subscribing to Blockchain Events</a></li>
<li><a href="#211-triggering-a-subscription-notification">2.11. Triggering a Subscription Notification</a></li>
</ul>
</li>
<li><a href="#3-grpc-protobuf-definitions">gRPC Protobuf Definitions</a></li>
<li><a href="#4-data-model">Data Model</a></li>
<li><a href="#5-technology">Technology</a></li>
<li><a href="#6-directory-structure-and-main-files">Directory Structure and Main Files</a></li>
<li><a href="#7-how-to-run">How to run</a></li>
<li><a href="#8-configuration">Configuration</a></li>
<li><a href="#9-additional-technical-details">Additional Technical Details</a><ul>
<li><a href="#91-complete-grpc-method-coverage">9.1. Complete gRPC Method Coverage</a></li>
<li><a href="#92-finite-state-machine-implementation">9.2. Finite State Machine Implementation</a></li>
<li><a href="#93-kafka-integration-details">9.3. Kafka Integration Details</a></li>
<li><a href="#94-error-handling-strategies">9.4. Error Handling Strategies</a></li>
</ul>
</li>
<li><a href="#10-other-resources">Other Resources</a></li>
</ol>
<h2 id="1-description">1. Description</h2>
<p>This service implements a local Bitcoin SV (BSV) Blockchain service, maintaining the blockchain as understood by the node.</p>
<p>The service exposes various RPC methods such as <code>AddBlock</code>, <code>GetBlock</code>, <code>InvalidateBlock</code> and <code>Subscribe</code>.</p>
<p>The main features of the service are:</p>
<ol>
<li>
<p><strong>Subscription Management</strong>: The service can handle live subscriptions. Clients can subscribe to blockchain events, and the service will send them notifications. It manages new and dead subscriptions and sends out notifications accordingly.</p>
</li>
<li>
<p><strong>Adding a new Block to the Blockchain</strong>: Allows adding a new block to the blockchain. It accepts a block request, processes it, and stores it in the blockchain store. Notifications are sent out about this new block.</p>
</li>
<li>
<p><strong>Block Retrieval</strong>: Provides various methods to retrieve block information (<code>GetBlock</code>, <code>GetLastNBlocks</code>, <code>GetBlockExists</code> functions).</p>
</li>
<li>
<p><strong>Block Invalidation</strong>: It allows to invalidate blocks (<code>InvalidateBlock</code> function), as part of a rollback process.</p>
</li>
</ol>
<blockquote>
<p><strong>Note</strong>: For information about how the Blockchain service is initialized during daemon startup and how it interacts with other services, see the <a href="../../../references/teranodeDaemonReference/#service-initialization-flow">Teranode Daemon Reference</a>.</p>
</blockquote>
<p><img alt="Blockchain_Service_Container_Diagram.png" src="../img/Blockchain_Service_Container_Diagram.png" /></p>
<p>To fulfill its purpose, the service interfaces with a blockchain store for data persistence and retrieval.</p>
<p><img alt="Blockchain_Service_Component_Diagram.png" src="../img/Blockchain_Service_Component_Diagram.png" /></p>
<h2 id="2-functionality">2. Functionality</h2>
<h3 id="21-service-initialization">2.1. Service initialization</h3>
<p><img alt="blockchain_init.svg" src="../img/plantuml/blockchain/blockchain_init.svg" /></p>
<p>Explanation of the sequence:</p>
<ol>
<li>
<p><strong>New Method:</strong></p>
<ul>
<li>The <code>Main</code> requests a new instance of the <code>Blockchain</code> service by calling the <code>New</code> function with a logger.</li>
<li>Inside the <code>New</code> method, the <code>Blockchain Service</code> performs initialization tasks including setting up the blockchain store, initializing various channels, and preparing the context and subscriptions.</li>
</ul>
</li>
<li>
<p><strong>Start Method:</strong></p>
<ul>
<li>The <code>Main</code> calls the <code>Start</code> method on the <code>Blockchain</code> service instance.</li>
<li>The <code>Blockchain Service</code> starts server operations, including channel listeners and the GRPC server.</li>
<li>The service enters a loop handling notifications and subscriptions.</li>
</ul>
</li>
</ol>
<h3 id="22-adding-a-new-block-to-the-blockchain">2.2. Adding a new block to the blockchain</h3>
<p>There are 2 clients invoking this endpoint:</p>
<ol>
<li><strong>The <code>Block Assembly</code> service:</strong><ul>
<li>The <code>Block Assembly</code> service calls the <code>AddBlock</code> method on the <code>Blockchain Service</code> to add a new mined block to the blockchain.</li>
</ul>
</li>
</ol>
<p>The sequence diagram for the Block Assembly to add a new block to the blockchain is as follows:</p>
<p><img alt="blockchain_add_block.svg" src="../img/plantuml/blockchain/blockchain_add_block.svg" />
2. <strong>The <code>Block Validation</code> service:</strong>
    - The <code>Block Validation</code> service calls the <code>AddBlock</code> method on the <code>Blockchain Service</code> to add a new block (received from another node) to the blockchain.</p>
<p>The sequence diagram for the Block Validation to add a new block to the blockchain is as follows:</p>
<p><img alt="block_validation_p2p_block_validation.svg" src="../img/plantuml/blockvalidation/block_validation_p2p_block_validation.svg" />
Explanation of the sequences:</p>
<ol>
<li>
<p><strong>Client Request:</strong></p>
<ul>
<li>The <code>Client</code> calls the <code>AddBlock</code> method on the <code>Blockchain Service</code>, passing the block request.</li>
</ul>
</li>
<li>
<p><strong>Parse Block Header:</strong></p>
<ul>
<li>The <code>Blockchain Service</code> parses the block header from the request. If there's an error, it returns the error to the client and the process stops.</li>
</ul>
</li>
<li>
<p><strong>Parse Coinbase Transaction:</strong></p>
<ul>
<li>If the header parsing is successful, the service then parses the coinbase transaction. Again, if there's an error, it returns the error to the client.</li>
</ul>
</li>
<li>
<p><strong>Parse Subtree Hashes:</strong></p>
<ul>
<li>If the coinbase transaction parsing is successful, the service then parses the subtree hashes. If there's an error in parsing, it returns the error to the client.</li>
</ul>
</li>
<li>
<p><strong>Store Block:</strong></p>
<ul>
<li>If all parsing steps are successful, the <code>Blockchain Service</code> stores the block using the <code>Block Store</code>.</li>
</ul>
</li>
<li>
<p><strong>Handle Storage Response:</strong></p>
<ul>
<li>If there's an error in storing the block, the <code>Blockchain Service</code> returns the error to the client.</li>
<li>If the block is stored successfully, the <code>Blockchain Service</code> proceeds to send notifications.</li>
</ul>
</li>
<li>
<p><strong>Send Notifications:</strong></p>
<ul>
<li>The service sends notifications for the block.</li>
</ul>
</li>
</ol>
<h3 id="23-sending-new-block-notifications-to-the-block-persister">2.3. Sending new block notifications to the Block Persister</h3>
<p>The Blockchain service, after adding a new block, emits a Kafka notification which is received by the Block Persister service. The Block Persister service is responsible for post-processing the block and storing it in a file format, in a persistent data store (such as S3).</p>
<p><img alt="blockchain_send_to_block_persister.svg" src="../img/plantuml/blockchain/blockchain_send_to_block_persister.svg" /></p>
<p>The Blockchain service, based on standard practices, will retry sending the message until Kafka receives it. In case of Kafka downtime, the service will keep retrying for as long as the message is not sent.</p>
<h3 id="24-getting-a-block-from-the-blockchain">2.4. Getting a block from the blockchain</h3>
<p><img alt="blockchain_get_block.svg" src="../img/plantuml/blockchain/blockchain_get_block.svg" /></p>
<p>Explanation of the sequence:</p>
<ol>
<li>
<p><strong>Client Request:</strong></p>
<ul>
<li>The <code>Client</code> calls the <code>GetBlock</code> method on the <code>Blockchain Service</code>, passing the context and the request.</li>
</ul>
</li>
<li>
<p><strong>Parse Block Hash:</strong></p>
<ul>
<li>The <code>Blockchain Service</code> uses the <code>Model</code> to parse the block hash from the request. If there's an error, it returns the error to the client.</li>
</ul>
</li>
<li>
<p><strong>Retrieve Block from Store:</strong></p>
<ul>
<li>If the hash parsing is successful, the service then retrieves the block from the <code>Store</code> using the parsed hash.</li>
</ul>
</li>
<li>
<p><strong>Handle Store Response:</strong></p>
<ul>
<li>If there's an error in retrieving the block, the service returns the error to the client.</li>
<li>If the block is successfully retrieved, the service proceeds to prepare the response.</li>
</ul>
</li>
<li>
<p><strong>Prepare Response:</strong></p>
<ul>
<li>The service loops through each subtree hash in the block, converting them to bytes.</li>
<li>The service creates a <code>GetBlockResponse</code> with the block's header, height, coinbase transaction, subtree hashes, transaction count, and size in bytes.</li>
</ul>
</li>
<li>
<p><strong>Return Response:</strong></p>
<ul>
<li>The <code>Blockchain Service</code> returns the prepared <code>GetBlockResponse</code> to the <code>Client Code</code>.</li>
</ul>
</li>
</ol>
<p>There are 2 clients invoking this endpoint:</p>
<ol>
<li>
<p><strong>The <code>Asset Server</code> service:</strong></p>
<ul>
<li>The <code>Asset Server</code> service calls the <code>GetBlock</code> method on the <code>Blockchain Service</code> to retrieve a block from the blockchain.</li>
</ul>
</li>
<li>
<p><strong>The <code>Block Assembly</code> service:</strong></p>
</li>
<li>The <code>Block Assembly</code> service calls the <code>GetBlock</code> method on the <code>Blockchain Service</code> to retrieve a block from the blockchain.</li>
</ol>
<h3 id="25-getting-the-last-n-blocks-from-the-blockchain">2.5. Getting the last N blocks from the blockchain</h3>
<p><img alt="blockchain_get_last_n_blocks.svg" src="../img/plantuml/blockchain/blockchain_get_last_n_blocks.svg" /></p>
<p>Explanation of the sequence:</p>
<ol>
<li>
<p><strong>Client Request:</strong></p>
<ul>
<li>The <code>Client</code> initiates a call to the <code>GetLastNBlocks</code> method on the <code>Blockchain Service</code>, passing the context and the request.</li>
</ul>
</li>
<li>
<p><strong>Retrieve Blocks from Store:</strong></p>
<ul>
<li>The <code>Blockchain Service</code> then calls the <code>GetLastNBlocks</code> method on the <code>Store</code>, passing the number of blocks, orphan inclusion flag, and the starting height from the request.</li>
</ul>
</li>
<li>
<p><strong>Handle Store Response:</strong></p>
<ul>
<li>If there's an error in retrieving the last N blocks, the service returns the error to the client.</li>
<li>If the blocks are successfully retrieved, the service prepares the response.</li>
</ul>
</li>
<li>
<p><strong>Prepare and Return Response:</strong></p>
<ul>
<li>The <code>Blockchain Service</code> creates a <code>GetLastNBlocksResponse</code> containing the retrieved <code>blockInfo</code>.</li>
<li>It then returns this response to the <code>Client</code>.</li>
</ul>
</li>
</ol>
<p>The <code>Asset Server</code> service is the only client invoking this endpoint. It calls the <code>GetLastNBlocks</code> method on the <code>Blockchain Service</code> to retrieve the last N blocks from the blockchain.</p>
<h3 id="26-checking-if-a-block-exists-in-the-blockchain">2.6. Checking if a Block Exists in the Blockchain</h3>
<p><img alt="blockchain_check_exists.svg" src="../img/plantuml/blockchain/blockchain_check_exists.svg" /></p>
<p>Explanation of the sequence:</p>
<ol>
<li>
<p><strong>Client Request:</strong></p>
<ul>
<li>The <code>Client</code> initiates a call to the <code>GetBlockExists</code> method on the <code>Blockchain Service</code>, providing the context and request (which includes the block hash).</li>
</ul>
</li>
<li>
<p><strong>Retrieve Block Existence from Store:</strong></p>
<ul>
<li>The <code>Blockchain Service</code> processes the request by first converting the provided hash in the request to a <code>chainhash.Hash</code> object.</li>
<li>It then queries the <code>Store</code> to check if the block exists, using the adjusted context (<code>ctx1</code>) and the block hash.</li>
</ul>
</li>
<li>
<p><strong>Handle Store Response:</strong></p>
<ul>
<li>If there's an error in checking the existence of the block, the service returns the error to the client.</li>
<li>If the existence check is successful, the service prepares the response.</li>
</ul>
</li>
<li>
<p><strong>Prepare and Return Response:</strong></p>
<ul>
<li>The <code>Blockchain Service</code> creates a <code>GetBlockExistsResponse</code>, indicating whether the block exists or not.</li>
<li>It then returns this response to the <code>Client</code>.</li>
</ul>
</li>
</ol>
<p>The <code>Block Validation</code> service is the only client invoking this endpoint. It calls the <code>GetBlockExists</code> method on the <code>Blockchain Service</code> to check if a block exists in the blockchain.</p>
<h3 id="27-getting-the-best-block-header">2.7. Getting the Best Block Header</h3>
<p><img alt="blockchain_get_best_block_header.svg" src="../img/plantuml/blockchain/blockchain_get_best_block_header.svg" /></p>
<p>Explanation of the sequence:</p>
<ol>
<li>
<p><strong>Client Request:</strong></p>
<ul>
<li>The <code>Client</code> initiates a call to the <code>GetBestBlockHeader</code> method on the <code>Blockchain Service</code>, providing the context and an empty message.</li>
</ul>
</li>
<li>
<p><strong>Retrieve Best Block Header from Store:</strong></p>
<ul>
<li>The <code>Blockchain Service</code> processes the request by querying the <code>Store</code> for the best block header, using the adjusted context (<code>ctx1</code>).</li>
</ul>
</li>
<li>
<p><strong>Handle Store Response:</strong></p>
<ul>
<li>If there's an error in retrieving the best block header, the service returns the error to the client.</li>
<li>If the retrieval is successful, the service prepares the response.</li>
</ul>
</li>
<li>
<p><strong>Prepare and Return Response:</strong></p>
<ul>
<li>The <code>Blockchain Service</code> creates a <code>GetBlockHeaderResponse</code> with the block header, height, transaction count, size in bytes, and miner information.</li>
<li>It then returns this response to the <code>Client</code>.</li>
</ul>
</li>
</ol>
<p>Multiple services make use of this endpoint, including the <code>Block Assembly</code>, <code>P2P Server</code>, and <code>Asset Server</code> services, as well as the <code>UTXO Store</code>.</p>
<h3 id="28-getting-the-block-headers">2.8. Getting the Block Headers</h3>
<p>The methods <code>GetBlockHeader</code>, <code>GetBlockHeaders</code>, and <code>GetBlockHeaderIDs</code> in the <code>Blockchain</code> service provide different ways to retrieve information about blocks in the blockchain.</p>
<p><img alt="blockchain_get_block_header.svg" src="../img/plantuml/blockchain/blockchain_get_block_header.svg" /></p>
<ol>
<li>
<p><strong>GetBlockHeader:</strong></p>
<ul>
<li><strong>Purpose:</strong> Retrieves a single block header.</li>
<li><strong>Process:</strong><ul>
<li>It takes a <code>GetBlockHeaderRequest</code> containing the hash of the desired block.</li>
<li>Converts the hash into a <code>chainhash.Hash</code> object.</li>
<li>Calls <code>GetBlockHeader</code> on the store, providing the context and the hash, to fetch the block header and associated metadata.</li>
<li>If successful, it creates and returns a <code>GetBlockHeaderResponse</code> containing the block header's byte representation and metadata like height, transaction count, size, and miner.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>GetBlockHeaders:</strong></p>
<ul>
<li><strong>Purpose:</strong> Fetches multiple block headers starting from a given hash.</li>
<li><strong>Process:</strong><ul>
<li>Accepts a <code>GetBlockHeadersRequest</code> with the starting block hash and the number of headers to retrieve.</li>
<li>Converts the starting hash into a <code>chainhash.Hash</code> object.</li>
<li>Calls <code>GetBlockHeaders</code> on the store to obtain a list of block headers and their heights.</li>
<li>Assembles the headers into a byte array and returns them in a <code>GetBlockHeadersResponse</code>.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>GetBlockHeaderIDs:</strong></p>
<ul>
<li><strong>Purpose:</strong> Retrieves the IDs (hashes) of a range of block headers.</li>
<li><strong>Process:</strong><ul>
<li>Receives a <code>GetBlockHeadersRequest</code> similar to <code>GetBlockHeaders</code>.</li>
<li>Converts the start hash to a <code>chainhash.Hash</code> object.</li>
<li>Uses the store's <code>GetBlockHeaderIDs</code> method to fetch the IDs of the requested block headers.</li>
<li>Returns the IDs in a <code>GetBlockHeaderIDsResponse</code>.</li>
</ul>
</li>
</ul>
</li>
</ol>
<p>Each of these methods serves a specific need:</p>
<ul>
<li><code>GetBlockHeader</code> is for fetching detailed information about a single block.</li>
<li><code>GetBlockHeaders</code> is useful for getting information about a sequence of blocks.</li>
<li><code>GetBlockHeaderIDs</code> provides a lighter way to retrieve just the IDs of a range of block headers without the additional metadata.</li>
</ul>
<p>Multiple services make use of these endpoints, including the <code>Block Assembly</code>, <code>Block Validation</code>, and <code>Asset Server</code> services.</p>
<h3 id="29-invalidating-a-block">2.9. Invalidating a Block</h3>
<p><img alt="blockchain_invalidate_block.svg" src="../img/plantuml/blockchain/blockchain_invalidate_block.svg" /></p>
<ol>
<li>The <code>Block Assembly</code> sends an <code>InvalidateBlock</code> request to the <code>Blockchain Service</code>.</li>
<li>The <code>Blockchain Service</code> processes the request and calls the <code>InvalidateBlock</code> method on the <code>Store</code>, passing the block hash.</li>
<li>The <code>Store</code> performs the invalidation operation and returns the result (success or error) back to the <code>Blockchain Service</code>.</li>
<li>Finally, the <code>Blockchain Service</code> returns a response to the <code>Client</code>, which is either an empty response (indicating success) or an error message.</li>
</ol>
<h3 id="210-subscribing-to-blockchain-events">2.10. Subscribing to Blockchain Events</h3>
<p>The Blockchain service provides a subscription mechanism for clients to receive notifications about blockchain events.</p>
<p><img alt="blockchain_subscribe.svg" src="../img/plantuml/blockchain/blockchain_subscribe.svg" /></p>
<p>In this diagram, the sequence of operations is as follows:</p>
<ol>
<li>The <code>Client</code> sends a <code>Subscribe</code> request to the <code>Blockchain Client</code>.</li>
<li>The <code>Blockchain Server</code> receives the subscription request and adds it to the <code>Subscription Store</code> (a map of subscriber channels).</li>
<li>The server then enters a loop where it waits for either the client's context to be done (indicating disconnection) or the subscription to end.</li>
<li>If the client's context is done, the server logs the disconnection and breaks out of the loop. If the subscription ends, the loop is also exited.</li>
<li>The server then sends back a response to the client, indicating that the subscription has been established or ended.</li>
<li>On the client side, after establishing the subscription, it manages the subscription by continuously receiving stream notifications from the server and processing them as they arrive.</li>
</ol>
<p>Multiple services make use of the subscription service, including the <code>Block Assembly</code>, <code>Block Validation</code>, <code>P2P</code>, and <code>Asset Server</code> services, and <code>UTXO</code> store. To know more, check the documentation of those services.</p>
<h3 id="211-triggering-a-subscription-notification">2.11. Triggering a Subscription Notification</h3>
<p>There are two distinct paths for sending notifications, notifications originating from the <code>Blockchain Server</code> and notifications originating from a <code>Blockchain Client</code> gRPC client.</p>
<p><img alt="blockchain_send_notifications.svg" src="../img/plantuml/blockchain/blockchain_send_notifications.svg" /></p>
<ol>
<li>
<p><strong>Path 1: Notification Originating from Blockchain Server</strong></p>
<ul>
<li>The <code>Blockchain Server</code> processes an <code>AddBlock</code> or a <code>SetBlockSubtreesSet</code> call. The <code>AddBlock</code> sequence can be seen in the diagram above.</li>
<li>Inside this method, it creates a notification of type <code>MiningOn</code> or <code>Block</code>.</li>
<li>The server then calls its own <code>SendNotification</code> method to disseminate this notification.</li>
<li>The <code>Subscription Store</code> is queried to send the notification to all relevant subscribers.</li>
</ul>
</li>
<li>
<p><strong>Path 2: Notification from Block Assembly Through Blockchain Client</strong></p>
<ul>
<li>The <code>Block Assembly</code> component requests the <code>Blockchain Client</code> to send a notification, of type <code>model.NotificationType_Subtree</code>.</li>
<li>The <code>Blockchain Client</code> then communicates with the <code>Blockchain Server</code> to invoke the <code>SendNotification</code> method.</li>
<li>Similar to Path 1, the server uses the <code>Subscription Store</code> to distribute the notification to all subscribers.</li>
</ul>
</li>
</ol>
<p>In both scenarios, the mechanism for reaching the subscribers through the <code>Subscription Store</code> remains consistent.</p>
<p>For further detail, we show here the sequence for the <code>SetBlockSubtreesSet</code> call, not detailed in the diagram above.</p>
<p><img alt="blockchain_setblocksubtreesset.svg" src="../img/plantuml/blockchain/blockchain_setblocksubtreesset.svg" /></p>
<h2 id="3-grpc-protobuf-definitions">3. gRPC Protobuf Definitions</h2>
<p>The Blockchain Service uses gRPC for communication between nodes. The protobuf definitions used for defining the service methods and message formats can be seen <a href="../../../references/protobuf_docs/blockchainProto/">here</a>.</p>
<h2 id="4-data-model">4. Data Model</h2>
<p>The Blockchain works with the <a href="../../datamodel/block_data_model/">Block Data Model</a>.</p>
<p>The blockchain database stores the block header, coinbase TX, and block merkle root. The following is the structure of the <code>blocks</code> data:</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Constraints</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>BIGSERIAL</td>
<td>PRIMARY KEY</td>
<td>Unique identifier for each block.</td>
</tr>
<tr>
<td>parent_id</td>
<td>BIGSERIAL</td>
<td>REFERENCES blocks(id)</td>
<td>Identifier of the parent block.</td>
</tr>
<tr>
<td>version</td>
<td>INTEGER</td>
<td>NOT NULL</td>
<td>Version of the block.</td>
</tr>
<tr>
<td>hash</td>
<td>BYTEA</td>
<td>NOT NULL</td>
<td>Hash of the block.</td>
</tr>
<tr>
<td>previous_hash</td>
<td>BYTEA</td>
<td>NOT NULL</td>
<td>Hash of the previous block.</td>
</tr>
<tr>
<td>merkle_root</td>
<td>BYTEA</td>
<td>NOT NULL</td>
<td>Merkle root of the block.</td>
</tr>
<tr>
<td>block_time</td>
<td>BIGINT</td>
<td>NOT NULL</td>
<td>Timestamp of when the block was created.</td>
</tr>
<tr>
<td>n_bits</td>
<td>BYTEA</td>
<td>NOT NULL</td>
<td>Compact form of the block's target difficulty.</td>
</tr>
<tr>
<td>nonce</td>
<td>BIGINT</td>
<td>NOT NULL</td>
<td>Nonce used during the mining process.</td>
</tr>
<tr>
<td>height</td>
<td>BIGINT</td>
<td>NOT NULL</td>
<td>Height of the block in the blockchain.</td>
</tr>
<tr>
<td>chain_work</td>
<td>BYTEA</td>
<td>NOT NULL</td>
<td>Cumulative proof of work of the blockchain up to this block.</td>
</tr>
<tr>
<td>tx_count</td>
<td>BIGINT</td>
<td>NOT NULL</td>
<td>Number of transactions in the block.</td>
</tr>
<tr>
<td>size_in_bytes</td>
<td>BIGINT</td>
<td>NOT NULL</td>
<td>Size of the block in bytes.</td>
</tr>
<tr>
<td>subtree_count</td>
<td>BIGINT</td>
<td>NOT NULL</td>
<td>Number of subtrees in the block.</td>
</tr>
<tr>
<td>subtrees</td>
<td>BYTEA</td>
<td>NOT NULL</td>
<td>Serialized data of the subtrees.</td>
</tr>
<tr>
<td>coinbase_tx</td>
<td>BYTEA</td>
<td>NOT NULL</td>
<td>Serialized data of the coinbase transaction.</td>
</tr>
<tr>
<td>invalid</td>
<td>BOOLEAN</td>
<td>NOT NULL DEFAULT FALSE</td>
<td>Flag to mark the block as valid or invalid.</td>
</tr>
<tr>
<td>peer_id</td>
<td>VARCHAR(64)</td>
<td>NOT NULL</td>
<td>Identifier of the peer that provided the block.</td>
</tr>
<tr>
<td>inserted_at</td>
<td>TIMESTAMPTZ</td>
<td>NOT NULL DEFAULT CURRENT_TIMESTAMP</td>
<td>Timestamp of when the block was inserted in the database.</td>
</tr>
</tbody>
</table>
<p>The table structure is designed to store comprehensive information about each block in the blockchain, including its relationships with other blocks, its contents, and metadata.</p>
<h2 id="5-technology">5. Technology</h2>
<ol>
<li>
<p><strong>PostgreSQL Database:</strong></p>
<ul>
<li>The primary store technology for the blockchain service.</li>
<li>Used for persisting blockchain data such as blocks, block headers, and state information.</li>
<li>SQL scripts and functions (<code>/stores/blockchain/sql</code>) facilitate querying and manipulating blockchain data within the PostgreSQL database.</li>
</ul>
</li>
<li>
<p><strong>Go Programming Language:</strong></p>
<ul>
<li>The service is implemented in Go (Golang).</li>
</ul>
</li>
<li>
<p><strong>gRPC and Protocol Buffers:</strong></p>
<ul>
<li>The service uses gRPC for inter-service communication.</li>
<li>Protocol Buffers (<code>.proto</code> files) are used for defining the service API and data structures, ensuring efficient and strongly-typed data exchange.</li>
</ul>
</li>
<li>
<p><strong>gocore Library:</strong></p>
<ul>
<li>Utilized for managing application configurations and statistics gathering.</li>
</ul>
</li>
<li>
<p><strong>Model Layer (in <code>/model</code>):</strong></p>
<ul>
<li>Represents the data structures and business logic related to blockchain operations.</li>
<li>Contains definitions for blocks and other blockchain components.</li>
</ul>
</li>
<li>
<p><strong>Prometheus for Metrics:</strong></p>
<ul>
<li>Client in <code>metrics.go</code>.</li>
<li>Used for monitoring the performance and health of the service.</li>
</ul>
</li>
</ol>
<h2 id="6-directory-structure-and-main-files">6. Directory Structure and Main Files</h2>
<p>The Blockchain service is located in the <code>./services/blockchain</code> directory. The following is the directory structure of the service:</p>
<div class="highlight"><pre><span></span><code>services/blockchain
 Client.go - Implements the client-side logic for interacting with the Blockchain service.
 Difficulty.go - Manages difficulty adjustment logic for the blockchain.
 Interface.go - Defines the interface for the Blockchain store, outlining required methods for implementation.
 LocalClient.go - Provides a local client implementation for the Blockchain service, for internal or in-process use.
 Server.go - Contains server-side logic for the Blockchain service, handling requests and processing blockchain operations.
 blockchain_api
    blockchain_api.pb.go - Auto-generated Go bindings from the `.proto` file, used for implementing the Blockchain service API.
    blockchain_api.proto - The Protocol Buffers definition file for the Blockchain service API.
    blockchain_api_extra.go - Supplemental code extending or enhancing the auto-generated API code.
    blockchain_api_grpc.pb.go - Auto-generated gRPC bindings from the `.proto` file, specifically for gRPC communication.
    fsm_extra.go - Additional logic related to the Finite State Machine (FSM) functionality.
 data
|
 fsm.go
   - Implements the Finite State Machine logic for managing blockchain states.

 fsm_visualizer
    main.go  - A tool for visualizing the Finite State Machine structure.

 metrics.go
   - Manages and implements functionality related to operational metrics of the Blockchain service.

 work
     work.go
        - Used to compute the cumulative chain work.
</code></pre></div>
<p>Further to this, the store part of the service is kept under <code>stores/blockchain</code>. The following is the directory structure of the store:</p>
<div class="highlight"><pre><span></span><code>stores/blockchain
 Interface.go
    - Defines the interface for blockchain storage, outlining the methods for blockchain data manipulation and retrieval.
 README.md
    - Contains documentation and information about the blockchain store.
 mock.go
    - Likely contains mock implementations for testing purposes.
 new.go
    - Contains the constructor or factory methods for creating new instances of the blockchain store.
 options
    Options.go
    - Defines options or configurations for the blockchain store.
 sql
     CheckBlockIsInCurrentChain.go
     CheckBlockIsInCurrentChain_test.go
     ExportBlocksDB.go
     GetBestBlockHeader.go
     GetBestBlockHeader_test.go
     GetBlock.go
     GetBlockByHeight.go
     GetBlockByHeight_test.go
     GetBlockExists.go
     GetBlockGraphData.go
     GetBlockHeader.go
     GetBlockHeaderIDs.go
     GetBlockHeaderIDs_test.go
     GetBlockHeaders.go
     GetBlockHeadersByHeight.go
     GetBlockHeadersFromHeight.go
     GetBlockHeaders_test.go
     GetBlockHeight.go
     GetBlockHeight_test.go
     GetBlockStats.go
     GetBlock_test.go
     GetBlocks.go
     GetBlocksByTime.go
     GetBlocksMinedNotSet.go
     GetBlocksSubtreesNotSet.go
     GetForkedBlockHeaders.go
     GetHashOfAncestorBlock.go
     GetHashOfAncestorBlock_test.go
     GetHeader.go
     GetHeader_test.go
     GetLastNBlocks.go
     GetSuitableBlock.go
     GetSuitableBlock_test.go
     InvalidateBlock.go
     InvalidateBlock_test.go
     LocateBlockHeaders.go
     LocateBlockHeaders_test.go
     RevalidateBlock.go
     RevalidateBlock_test.go
     SetBlockMinedSet.go
     SetBlockSubtreesSet.go
     State.go
     State_test.go
     StoreBlock.go
     StoreBlock_test.go
     sql.go
     sql_test.go
</code></pre></div>
<h2 id="7-how-to-run">7. How to run</h2>
<p>To run the Blockchain Service locally, you can execute the following command:</p>
<div class="highlight"><pre><span></span><code><span class="nv">SETTINGS_CONTEXT</span><span class="o">=</span>dev.<span class="o">[</span>YOUR_USERNAME<span class="o">]</span><span class="w"> </span>go<span class="w"> </span>run<span class="w"> </span>-Blockchain<span class="o">=</span><span class="m">1</span>
</code></pre></div>
<p>Please refer to the <a href="../../../howto/locallyRunningServices/">Locally Running Services Documentation</a> document for more information on running the Blockchain Service locally.</p>
<h2 id="8-configuration">8. Configuration</h2>
<p>For comprehensive configuration documentation including all settings, defaults, and interactions, see the <a href="../../../references/settings/services/blockchain_settings/">Blockchain Settings Reference</a>.</p>
<h2 id="9-additional-technical-details">9. Additional Technical Details</h2>
<h3 id="91-complete-grpc-method-coverage">9.1. Complete gRPC Method Coverage</h3>
<p>In addition to the core methods described in the Functionality section, the Blockchain Service provides the following API endpoints:</p>
<h4 id="fsm-management-methods">FSM Management Methods</h4>
<ul>
<li><strong>SendFSMEvent</strong>: Sends an event to the blockchain FSM to trigger state transitions.</li>
<li><strong>GetFSMCurrentState</strong>: Retrieves the current state of the FSM.</li>
<li><strong>WaitFSMToTransitionToGivenState</strong>: Waits for FSM to reach a specific state.</li>
<li><strong>WaitUntilFSMTransitionFromIdleState</strong>: Waits for FSM to transition from IDLE state.</li>
<li><strong>Run, CatchUpBlocks, LegacySync, Idle</strong>: Transitions the service to specific operational modes.</li>
</ul>
<h4 id="state-management">State Management</h4>
<ul>
<li><strong>GetState</strong>: Retrieves a value from the blockchain state storage by its key.</li>
<li><strong>SetState</strong>: Stores a value in the blockchain state storage with the specified key.</li>
</ul>
<h4 id="block-mining-status-methods">Block Mining Status Methods</h4>
<ul>
<li><strong>GetBlockIsMined</strong>: Checks if a block has been marked as mined.</li>
<li><strong>SetBlockMinedSet</strong>: Marks a block as mined in the blockchain.</li>
<li><strong>GetBlocksMinedNotSet</strong>: Retrieves blocks that haven't been marked as mined.</li>
<li><strong>SetBlockSubtreesSet</strong>: Marks a block's subtrees as set.</li>
<li><strong>GetBlocksSubtreesNotSet</strong>: Retrieves blocks whose subtrees haven't been set.</li>
</ul>
<h4 id="legacy-synchronization-methods">Legacy Synchronization Methods</h4>
<ul>
<li><strong>GetBlockLocator</strong>: Creates block locators for chain synchronization.</li>
<li><strong>LocateBlockHeaders</strong>: Finds block headers using a locator.</li>
<li><strong>GetBestHeightAndTime</strong>: Retrieves the current best height and median time.</li>
</ul>
<h3 id="92-finite-state-machine-implementation">9.2. Finite State Machine Implementation</h3>
<p>The Blockchain Service uses a Finite State Machine (FSM) to manage its operational states. This design allows the service to maintain a clear lifecycle and respond appropriately to different events.</p>
<p>For a comprehensive understanding of the Blockchain Service's FSM implementation, please refer to the dedicated <a href="../../architecture/stateManagement/">State Management in Teranode</a> documentation, which covers:</p>
<ul>
<li>FSM states (Idle, Running, CatchingBlocks, LegacySyncing)</li>
<li>State transitions and events</li>
<li>Allowed operations in each state</li>
<li>FSM initialization and access methods</li>
<li>Waiting on state transitions</li>
</ul>
<p>The FSM implementation in the Blockchain Service exposes several gRPC methods for state management:</p>
<ul>
<li><strong>GetFSMCurrentState</strong>: Returns the current state of the FSM</li>
<li><strong>WaitFSMToTransitionToGivenState</strong>: Waits for the FSM to reach a specific state</li>
<li><strong>SendFSMEvent</strong>: Sends events to trigger state transitions</li>
<li><strong>Run, CatchUpBlocks, LegacySync, Idle</strong>: Convenience methods that delegate to SendFSMEvent</li>
</ul>
<p>The FSM ensures that the service only performs operations appropriate for its current state, providing isolation and predictable behavior.</p>
<h3 id="93-kafka-integration-details">9.3. Kafka Integration Details</h3>
<p>The Blockchain Service integrates with Kafka for block notifications and event streaming:</p>
<h4 id="message-formats">Message Formats</h4>
<p>Block notifications are serialized using Protocol Buffers and contain:</p>
<ul>
<li>Block header</li>
<li>Block height</li>
<li>Hash</li>
<li>Transaction count</li>
<li>Size in bytes</li>
<li>Timestamp</li>
</ul>
<h4 id="topics">Topics</h4>
<ul>
<li><strong>Blocks-Final</strong>: Used for finalized block notifications, consumed by the Block Persister service.</li>
</ul>
<h4 id="error-handling">Error Handling</h4>
<ul>
<li>The service implements exponential backoff retry for Kafka publishing failures.</li>
<li>Failed messages are logged and retried based on the <code>blockchain_maxRetries</code> and <code>blockchain_retrySleep</code> settings.</li>
<li>Persistent failures, after the retries are exhausted, are reported through the health monitoring endpoints (<code>/health</code> HTTP endpoint and the <code>HealthGRPC</code> gRPC method).</li>
</ul>
<h3 id="94-error-handling-strategies">9.4. Error Handling Strategies</h3>
<p>The Blockchain Service employs several strategies to handle errors and maintain resilience:</p>
<h4 id="network-and-communication-errors">Network and Communication Errors</h4>
<ul>
<li>Uses timeouts and context cancellation to handle hanging network operations.</li>
<li>Implements retry mechanisms for transient failures with configured backoff periods.</li>
</ul>
<h4 id="validation-errors">Validation Errors</h4>
<ul>
<li>Blocks with invalid headers, merkle roots, or proofs are rejected with appropriate error codes.</li>
<li>Invalid blocks can be explicitly marked using the InvalidateBlock method.</li>
</ul>
<h4 id="chain-reorganization-and-longest-chain-tracking">Chain Reorganization and Longest Chain Tracking</h4>
<p>The Blockchain Service implements sophisticated chain reorganization handling with optimized longest chain tracking:</p>
<h5 id="automatic-detection">Automatic Detection</h5>
<ul>
<li>Detects chain splits and reorganizations automatically through block header validation</li>
<li>Uses rollback and catch-up operations to handle chain reorganizations</li>
<li>Limits reorganization depth for security (configurable via <code>blockchain_maxReorgDepth</code>)</li>
</ul>
<h5 id="optimized-longest-chain-selection">Optimized Longest Chain Selection</h5>
<p>The service employs an optimized algorithm for tracking and selecting the longest valid chain:</p>
<p><strong>Key Features:</strong></p>
<ul>
<li><strong>Efficient Chain Comparison</strong>: Uses cumulative proof-of-work (chainwork) rather than simple block height for chain selection</li>
<li><strong>Fast Fork Detection</strong>: Maintains indexed fork points to quickly identify competing chains</li>
<li><strong>Minimal Database Queries</strong>: Caches chain tips and their accumulated work to reduce database load</li>
<li><strong>Parallel Validation</strong>: Can validate multiple competing chain tips simultaneously</li>
</ul>
<p><strong>Implementation Details:</strong></p>
<ol>
<li><strong>Chainwork Tracking</strong>: Each block stores cumulative chainwork from genesis, allowing O(1) chain strength comparison</li>
<li><strong>Fork Point Cache</strong>: Maintains an in-memory cache of recent fork points for rapid reorganization detection</li>
<li><strong>Tip Management</strong>: Tracks multiple competing chain tips with their associated metadata:<ul>
<li>Total chainwork</li>
<li>Block height</li>
<li>Last validation timestamp</li>
<li>Fork depth from main chain</li>
</ul>
</li>
</ol>
<p><strong>Performance Benefits:</strong></p>
<ul>
<li>Reduced latency in chain selection during high fork activity</li>
<li>Lower database load through intelligent caching</li>
<li>Faster recovery from network partitions</li>
<li>Improved resilience to chain split scenarios</li>
</ul>
<p><strong>Configuration Options:</strong></p>
<ul>
<li><code>blockchain_maxReorgDepth</code>: Maximum allowed reorganization depth (default: 6 blocks)</li>
<li><code>blockchain_chainTipCacheSize</code>: Number of competing tips to track (default: 10)</li>
<li><code>blockchain_forkPointCacheSize</code>: Size of fork point cache (default: 100)</li>
</ul>
<h4 id="storage-errors">Storage Errors</h4>
<ul>
<li>Implements transaction-based operations with the store to maintain consistency.</li>
<li>Reports persistent storage errors through health endpoints.</li>
</ul>
<h2 id="10-other-resources">10. Other Resources</h2>
<ul>
<li><a href="../../../references/services/blockchain_reference/">Blockchain Reference</a></li>
<li><a href="../../architecture/stateManagement/">FSM Documentation</a></li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright  2025 BSV Blockchain Org.
    </div>
  
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/bsv-blockchain/teranode" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.instant", "search.suggest", "search.highlight"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../../assets/external/unpkg.com/mermaid@11/dist/mermaid.min.js"></script>
      
    
  </body>
</html>