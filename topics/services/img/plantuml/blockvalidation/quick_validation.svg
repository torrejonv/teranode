<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1418px" preserveAspectRatio="none" style="width:998px;height:1418px;background:#F0F8FF;" version="1.1" viewBox="0 0 998 1418" width="998px" zoomAndPan="magnify"><title>Quick Validation for Checkpointed Blocks</title><defs/><g><rect fill="#F0F8FF" height="1418" style="stroke:none;stroke-width:1.0;" width="998" x="0" y="0"/><text fill="#333333" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="299.4824" x="345.655" y="28.5352">Quick Validation for Checkpointed Blocks</text><rect fill="none" height="974.2031" style="stroke:#000000;stroke-width:1.5;" width="972.7925" x="9" y="223.9082"/><rect fill="none" height="97.2422" style="stroke:#000000;stroke-width:1.5;" width="817.5039" x="85" y="494.7031"/><rect fill="none" height="134.5527" style="stroke:#000000;stroke-width:1.5;" width="856.4736" x="85" y="715.1875"/><rect fill="none" height="67.9316" style="stroke:#000000;stroke-width:1.5;" width="453.4907" x="85" y="1255.4219"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="154" x2="154" y1="104.9766" y2="1340.3535"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="377.6133" x2="377.6133" y1="104.9766" y2="1340.3535"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="620.0371" x2="620.0371" y1="104.9766" y2="1340.3535"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="710.1748" x2="710.1748" y1="104.9766" y2="1340.3535"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="802.1895" x2="802.1895" y1="104.9766" y2="1340.3535"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="894.2949" x2="894.2949" y1="104.9766" y2="1340.3535"/><rect fill="#DDDDDD" height="30.4883" rx="2.5" ry="2.5" style="stroke:#666666;stroke-width:0.5;" width="118.1455" x="95" y="73.4883"/><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="104.1455" x="102" y="94.0234">BlockValidation</text><rect fill="#DDDDDD" height="30.4883" rx="2.5" ry="2.5" style="stroke:#666666;stroke-width:0.5;" width="118.1455" x="95" y="1339.3535"/><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="104.1455" x="102" y="1359.8887">BlockValidation</text><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81.5322" x="334.6133" y="102.0234">checkpoints</text><path d="M360.3794,52.4883 C360.3794,42.4883 378.3794,42.4883 378.3794,42.4883 C378.3794,42.4883 396.3794,42.4883 396.3794,52.4883 L396.3794,78.4883 C396.3794,88.4883 378.3794,88.4883 378.3794,88.4883 C378.3794,88.4883 360.3794,88.4883 360.3794,78.4883 L360.3794,52.4883 " fill="#DDDDDD" style="stroke:#666666;stroke-width:1.5;"/><path d="M360.3794,52.4883 C360.3794,62.4883 378.3794,62.4883 378.3794,62.4883 C378.3794,62.4883 396.3794,62.4883 396.3794,52.4883 " fill="none" style="stroke:#666666;stroke-width:1.5;"/><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81.5322" x="334.6133" y="1352.8887">checkpoints</text><path d="M360.3794,1365.8418 C360.3794,1355.8418 378.3794,1355.8418 378.3794,1355.8418 C378.3794,1355.8418 396.3794,1355.8418 396.3794,1365.8418 L396.3794,1391.8418 C396.3794,1401.8418 378.3794,1401.8418 378.3794,1401.8418 C378.3794,1401.8418 360.3794,1401.8418 360.3794,1391.8418 L360.3794,1365.8418 " fill="#DDDDDD" style="stroke:#666666;stroke-width:1.5;"/><path d="M360.3794,1365.8418 C360.3794,1375.8418 378.3794,1375.8418 378.3794,1375.8418 C378.3794,1375.8418 396.3794,1375.8418 396.3794,1365.8418 " fill="none" style="stroke:#666666;stroke-width:1.5;"/><rect fill="#DDDDDD" height="30.4883" rx="2.5" ry="2.5" style="stroke:#666666;stroke-width:0.5;" width="87.1377" x="577.0371" y="73.4883"/><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73.1377" x="584.0371" y="94.0234">blockchain</text><rect fill="#DDDDDD" height="30.4883" rx="2.5" ry="2.5" style="stroke:#666666;stroke-width:0.5;" width="87.1377" x="577.0371" y="1339.3535"/><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73.1377" x="584.0371" y="1359.8887">blockchain</text><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.0146" x="674.1748" y="102.0234">utxoStore</text><path d="M692.1821,52.4883 C692.1821,42.4883 710.1821,42.4883 710.1821,42.4883 C710.1821,42.4883 728.1821,42.4883 728.1821,52.4883 L728.1821,78.4883 C728.1821,88.4883 710.1821,88.4883 710.1821,88.4883 C710.1821,88.4883 692.1821,88.4883 692.1821,78.4883 L692.1821,52.4883 " fill="#DDDDDD" style="stroke:#666666;stroke-width:1.5;"/><path d="M692.1821,52.4883 C692.1821,62.4883 710.1821,62.4883 710.1821,62.4883 C710.1821,62.4883 728.1821,62.4883 728.1821,52.4883 " fill="none" style="stroke:#666666;stroke-width:1.5;"/><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.0146" x="674.1748" y="1352.8887">utxoStore</text><path d="M692.1821,1365.8418 C692.1821,1355.8418 710.1821,1355.8418 710.1821,1355.8418 C710.1821,1355.8418 728.1821,1355.8418 728.1821,1365.8418 L728.1821,1391.8418 C728.1821,1401.8418 710.1821,1401.8418 710.1821,1401.8418 C710.1821,1401.8418 692.1821,1401.8418 692.1821,1391.8418 L692.1821,1365.8418 " fill="#DDDDDD" style="stroke:#666666;stroke-width:1.5;"/><path d="M692.1821,1365.8418 C692.1821,1375.8418 710.1821,1375.8418 710.1821,1375.8418 C710.1821,1375.8418 728.1821,1375.8418 728.1821,1365.8418 " fill="none" style="stroke:#666666;stroke-width:1.5;"/><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86.1055" x="756.1895" y="102.0234">subtreeStore</text><path d="M784.2422,52.4883 C784.2422,42.4883 802.2422,42.4883 802.2422,42.4883 C802.2422,42.4883 820.2422,42.4883 820.2422,52.4883 L820.2422,78.4883 C820.2422,88.4883 802.2422,88.4883 802.2422,88.4883 C802.2422,88.4883 784.2422,88.4883 784.2422,78.4883 L784.2422,52.4883 " fill="#DDDDDD" style="stroke:#666666;stroke-width:1.5;"/><path d="M784.2422,52.4883 C784.2422,62.4883 802.2422,62.4883 802.2422,62.4883 C802.2422,62.4883 820.2422,62.4883 820.2422,52.4883 " fill="none" style="stroke:#666666;stroke-width:1.5;"/><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86.1055" x="756.1895" y="1352.8887">subtreeStore</text><path d="M784.2422,1365.8418 C784.2422,1355.8418 802.2422,1355.8418 802.2422,1355.8418 C802.2422,1355.8418 820.2422,1355.8418 820.2422,1365.8418 L820.2422,1391.8418 C820.2422,1401.8418 802.2422,1401.8418 802.2422,1401.8418 C802.2422,1401.8418 784.2422,1401.8418 784.2422,1391.8418 L784.2422,1365.8418 " fill="#DDDDDD" style="stroke:#666666;stroke-width:1.5;"/><path d="M784.2422,1365.8418 C784.2422,1375.8418 802.2422,1375.8418 802.2422,1375.8418 C802.2422,1375.8418 820.2422,1375.8418 820.2422,1365.8418 " fill="none" style="stroke:#666666;stroke-width:1.5;"/><rect fill="#DDDDDD" height="30.4883" rx="2.5" ry="2.5" style="stroke:#666666;stroke-width:0.5;" width="73.1787" x="858.2949" y="73.4883"/><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.1787" x="865.2949" y="94.0234">validator</text><rect fill="#DDDDDD" height="30.4883" rx="2.5" ry="2.5" style="stroke:#666666;stroke-width:0.5;" width="73.1787" x="858.2949" y="1339.3535"/><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.1787" x="865.2949" y="1359.8887">validator</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="991.7925" x="0" y="135.6318"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="991.7925" y1="135.6318" y2="135.6318"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="991.7925" y1="138.6318" y2="138.6318"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2.0;" width="190.7378" x="400.5273" y="124.9766"/><text fill="#333333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="172.4531" x="406.5273" y="141.5449">Quick Validation Decision</text><polygon fill="#666666" points="366.3794,175.5977,376.3794,179.5977,366.3794,183.5977,370.3794,179.5977" style="stroke:#666666;stroke-width:1.0;"/><line style="stroke:#666666;stroke-width:1.0;" x1="154.0728" x2="372.3794" y1="179.5977" y2="179.5977"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="200.3066" x="161.0728" y="174.8555">IsBlockBelowCheckpoint(height)</text><polygon fill="#666666" points="165.0728,204.9082,155.0728,208.9082,165.0728,212.9082,161.0728,208.9082" style="stroke:#666666;stroke-width:1.0;"/><line style="stroke:#666666;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="159.0728" x2="377.3794" y1="208.9082" y2="208.9082"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154.5146" x="171.0728" y="204.166">below/above checkpoint</text><path d="M9,223.9082 L71.1387,223.9082 L71.1387,231.2188 L61.1387,241.2188 L9,241.2188 L9,223.9082 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="974.2031" style="stroke:#000000;stroke-width:1.5;" width="972.7925" x="9" y="223.9082"/><text fill="#333333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="24" y="237.4766">alt</text><text fill="#333333" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="279.5601" x="86.1387" y="236.543">[Block Below Checkpoint - Quick Validation Path]</text><path d="M19,246.2188 L19,271.2188 L288,271.2188 L288,256.2188 L278,246.2188 L19,246.2188 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M278,246.2188 L278,256.2188 L288,256.2188 L278,246.2188 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="248.4409" x="25" y="263.7871">Quick validation for known valid blocks</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="991.7925" x="0" y="297.1846"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="991.7925" y1="297.1846" y2="297.1846"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="991.7925" y1="300.1846" y2="300.1846"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2.0;" width="218.4644" x="386.6641" y="286.5293"/><text fill="#333333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="200.1797" x="392.6641" y="303.0977">Phase 1: Pre-allocate Block ID</text><polygon fill="#666666" points="608.606,337.1504,618.606,341.1504,608.606,345.1504,612.606,341.1504" style="stroke:#666666;stroke-width:1.0;"/><line style="stroke:#666666;stroke-width:1.0;" x1="154.0728" x2="614.606" y1="341.1504" y2="341.1504"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.5962" x="161.0728" y="336.4082">GetNextBlockID()</text><polygon fill="#666666" points="165.0728,366.4609,155.0728,370.4609,165.0728,374.4609,161.0728,370.4609" style="stroke:#666666;stroke-width:1.0;"/><line style="stroke:#666666;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="159.0728" x2="619.606" y1="370.4609" y2="370.4609"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102.667" x="171.0728" y="365.7188">pre-allocated ID</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="991.7925" x="0" y="399.1162"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="991.7925" y1="399.1162" y2="399.1162"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="991.7925" y1="402.1162" y2="402.1162"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2.0;" width="192.9404" x="399.426" y="388.4609"/><text fill="#333333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="174.6558" x="405.426" y="405.0293">Phase 2: Create All UTXOs</text><line style="stroke:#666666;stroke-width:1.0;" x1="154.0728" x2="196.0728" y1="454.8926" y2="454.8926"/><line style="stroke:#666666;stroke-width:1.0;" x1="196.0728" x2="196.0728" y1="454.8926" y2="467.8926"/><line style="stroke:#666666;stroke-width:1.0;" x1="155.0728" x2="196.0728" y1="467.8926" y2="467.8926"/><polygon fill="#666666" points="165.0728,463.8926,155.0728,467.8926,165.0728,471.8926,161.0728,467.8926" style="stroke:#666666;stroke-width:1.0;"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151.9121" x="161.0728" y="450.1504">createAllUTXOs(parallel)</text><path d="M324.9121,426.7715 L324.9121,481.7715 L510.9121,481.7715 L510.9121,436.7715 L500.9121,426.7715 L324.9121,426.7715 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M500.9121,426.7715 L500.9121,436.7715 L510.9121,436.7715 L500.9121,426.7715 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.3501" x="330.9121" y="444.3398">Concurrent UTXO creation</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133.707" x="330.9121" y="459.6504">with pre-set block ID</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.2686" x="330.9121" y="474.9609">and mined status</text><path d="M85,494.7031 L159.4468,494.7031 L159.4468,502.0137 L149.4468,512.0137 L85,512.0137 L85,494.7031 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="97.2422" style="stroke:#000000;stroke-width:1.5;" width="817.5039" x="85" y="494.7031"/><text fill="#333333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.4468" x="100" y="508.2715">loop</text><text fill="#333333" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="177.8906" x="174.4468" y="507.3379">[For each transaction (parallel)]</text><polygon fill="#666666" points="698.1821,529.3242,708.1821,533.3242,698.1821,537.3242,702.1821,533.3242" style="stroke:#666666;stroke-width:1.0;"/><line style="stroke:#666666;stroke-width:1.0;" x1="154.0728" x2="704.1821" y1="533.3242" y2="533.3242"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="243.5532" x="161.0728" y="528.582">CreateUTXOs(tx, blockID, mined=true)</text><polygon fill="#666666" points="165.0728,569.29,155.0728,573.29,165.0728,577.29,161.0728,573.29" style="stroke:#666666;stroke-width:1.0;"/><line style="stroke:#666666;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="159.0728" x2="709.1821" y1="573.29" y2="573.29"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101.8545" x="171.0728" y="568.5479">success/conflict</text><path d="M715,546.3242 L715,586.3242 L887,586.3242 L887,556.3242 L877,546.3242 L715,546.3242 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M877,546.3242 L877,556.3242 L887,556.3242 L877,546.3242 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151.3218" x="721" y="563.8926">Handles existing UTXOs</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.2607" x="721" y="579.2031">gracefully for recovery</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="991.7925" x="0" y="619.6006"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="991.7925" y1="619.6006" y2="619.6006"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="991.7925" y1="622.6006" y2="622.6006"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2.0;" width="231.8262" x="379.9832" y="608.9453"/><text fill="#333333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="213.5415" x="385.9832" y="625.5137">Phase 3: Spend All Transactions</text><line style="stroke:#666666;stroke-width:1.0;" x1="154.0728" x2="196.0728" y1="675.377" y2="675.377"/><line style="stroke:#666666;stroke-width:1.0;" x1="196.0728" x2="196.0728" y1="675.377" y2="688.377"/><line style="stroke:#666666;stroke-width:1.0;" x1="155.0728" x2="196.0728" y1="688.377" y2="688.377"/><polygon fill="#666666" points="165.0728,684.377,155.0728,688.377,165.0728,692.377,161.0728,688.377" style="stroke:#666666;stroke-width:1.0;"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190.1694" x="161.0728" y="670.6348">spendAllTransactions(parallel)</text><path d="M363.1694,647.2559 L363.1694,702.2559 L515.1694,702.2559 L515.1694,657.2559 L505.1694,647.2559 L363.1694,647.2559 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M505.1694,647.2559 L505.1694,657.2559 L515.1694,657.2559 L505.1694,647.2559 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.2441" x="369.1694" y="664.8242">Optimized validation</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121.0054" x="369.1694" y="680.1348">skips policy checks</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.5073" x="369.1694" y="695.4453">for mined blocks</text><path d="M85,715.1875 L159.4468,715.1875 L159.4468,722.498 L149.4468,732.498 L85,732.498 L85,715.1875 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="134.5527" style="stroke:#000000;stroke-width:1.5;" width="856.4736" x="85" y="715.1875"/><text fill="#333333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.4468" x="100" y="728.7559">loop</text><text fill="#333333" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="177.8906" x="174.4468" y="727.8223">[For each transaction (parallel)]</text><polygon fill="#666666" points="882.8843,749.8086,892.8843,753.8086,882.8843,757.8086,886.8843,753.8086" style="stroke:#666666;stroke-width:1.0;"/><line style="stroke:#666666;stroke-width:1.0;" x1="154.0728" x2="888.8843" y1="753.8086" y2="753.8086"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="297.4194" x="161.0728" y="749.0664">ValidateTransaction(tx, skipPolicyChecks=true)</text><polygon fill="#666666" points="721.1821,779.1191,711.1821,783.1191,721.1821,787.1191,717.1821,783.1191" style="stroke:#666666;stroke-width:1.0;"/><line style="stroke:#666666;stroke-width:1.0;" x1="715.1821" x2="893.8843" y1="783.1191" y2="783.1191"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143.1968" x="727.1821" y="778.377">SpendInputs(tx.inputs)</text><polygon fill="#666666" points="882.8843,808.4297,892.8843,812.4297,882.8843,816.4297,886.8843,812.4297" style="stroke:#666666;stroke-width:1.0;"/><line style="stroke:#666666;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="710.1821" x2="888.8843" y1="812.4297" y2="812.4297"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="34.9819" x="717.1821" y="807.6875">spent</text><polygon fill="#666666" points="165.0728,837.7402,155.0728,841.7402,165.0728,845.7402,161.0728,841.7402" style="stroke:#666666;stroke-width:1.0;"/><line style="stroke:#666666;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="159.0728" x2="893.8843" y1="841.7402" y2="841.7402"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="29.6055" x="171.0728" y="836.998">valid</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="991.7925" x="0" y="877.3955"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="991.7925" y1="877.3955" y2="877.3955"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="991.7925" y1="880.3955" y2="880.3955"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2.0;" width="205.8008" x="392.9958" y="866.7402"/><text fill="#333333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="187.5161" x="398.9958" y="883.3086">Phase 4: Subtree Processing</text><polygon fill="#666666" points="790.2422,917.3613,800.2422,921.3613,790.2422,925.3613,794.2422,921.3613" style="stroke:#666666;stroke-width:1.0;"/><line style="stroke:#666666;stroke-width:1.0;" x1="154.0728" x2="796.2422" y1="921.3613" y2="921.3613"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="237.2373" x="161.0728" y="916.6191">CreateSubtreeMetadata(.subtreeMeta)</text><polygon fill="#666666" points="790.2422,957.3271,800.2422,961.3271,790.2422,965.3271,794.2422,961.3271" style="stroke:#666666;stroke-width:1.0;"/><line style="stroke:#666666;stroke-width:1.0;" x1="154.0728" x2="796.2422" y1="961.3271" y2="961.3271"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182.603" x="161.0728" y="956.585">ReconstructSubtree(.subtree)</text><path d="M807,934.3613 L807,974.3613 L966,974.3613 L966,944.3613 L956,934.3613 L807,934.3613 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M956,934.3613 L956,944.3613 L966,944.3613 L956,934.3613 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138.5503" x="813" y="951.9297">Non-extended format</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133.3706" x="813" y="967.2402">for storage efficiency</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="991.7925" x="0" y="1000.6377"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="991.7925" y1="1000.6377" y2="1000.6377"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="991.7925" y1="1003.6377" y2="1003.6377"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2.0;" width="235.5332" x="378.1296" y="989.9824"/><text fill="#333333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="217.2485" x="384.1296" y="1006.5508">Phase 5: Add Block with Options</text><polygon fill="#666666" points="608.606,1040.6035,618.606,1044.6035,608.606,1048.6035,612.606,1044.6035" style="stroke:#666666;stroke-width:1.0;"/><line style="stroke:#666666;stroke-width:1.0;" x1="154.0728" x2="614.606" y1="1044.6035" y2="1044.6035"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="442.5332" x="161.0728" y="1039.8613">AddBlock(block, WithID(id), WithMinedSet(true), WithSubtreesSet(true))</text><polygon fill="#666666" points="165.0728,1069.9141,155.0728,1073.9141,165.0728,1077.9141,161.0728,1073.9141" style="stroke:#666666;stroke-width:1.0;"/><line style="stroke:#666666;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="159.0728" x2="619.606" y1="1073.9141" y2="1073.9141"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77.2637" x="171.0728" y="1069.1719">block added</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="9" x2="981.7925" y1="1082.9141" y2="1082.9141"/><text fill="#333333" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="289.9907" x="14" y="1093.5488">[Block Above Checkpoint - Normal Validation Path]</text><path d="M44,1101.8691 L44,1126.8691 L263,1126.8691 L263,1111.8691 L253,1101.8691 L44,1101.8691 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M253,1101.8691 L253,1111.8691 L263,1111.8691 L253,1101.8691 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198.7515" x="50" y="1119.4375">Full validation for recent blocks</text><line style="stroke:#666666;stroke-width:1.0;" x1="154.0728" x2="196.0728" y1="1165.3008" y2="1165.3008"/><line style="stroke:#666666;stroke-width:1.0;" x1="196.0728" x2="196.0728" y1="1165.3008" y2="1178.3008"/><line style="stroke:#666666;stroke-width:1.0;" x1="155.0728" x2="196.0728" y1="1178.3008" y2="1178.3008"/><polygon fill="#666666" points="165.0728,1174.3008,155.0728,1178.3008,165.0728,1182.3008,161.0728,1178.3008" style="stroke:#666666;stroke-width:1.0;"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94.2373" x="161.0728" y="1160.5586">FullValidation()</text><path d="M267.2373,1137.1797 L267.2373,1192.1797 L453.2373,1192.1797 L453.2373,1147.1797 L443.2373,1137.1797 L267.2373,1137.1797 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M443.2373,1137.1797 L443.2373,1147.1797 L453.2373,1147.1797 L443.2373,1137.1797 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.4961" x="273.2373" y="1154.748">Complete script validation</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155.2954" x="273.2373" y="1170.0586">All policy checks applied</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128.6606" x="273.2373" y="1185.3691">Standard processing</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="991.7925" x="0" y="1225.7666"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="991.7925" y1="1225.7666" y2="1225.7666"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="991.7925" y1="1228.7666" y2="1228.7666"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2.0;" width="116.9146" x="437.439" y="1215.1113"/><text fill="#333333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="98.6299" x="443.439" y="1231.6797">Error Handling</text><path d="M85,1255.4219 L147.1387,1255.4219 L147.1387,1262.7324 L137.1387,1272.7324 L85,1272.7324 L85,1255.4219 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="67.9316" style="stroke:#000000;stroke-width:1.5;" width="453.4907" x="85" y="1255.4219"/><text fill="#333333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="100" y="1268.9902">alt</text><text fill="#333333" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="134.0625" x="162.1387" y="1268.0566">[Quick Validation Error]</text><line style="stroke:#666666;stroke-width:1.0;" x1="154.0728" x2="196.0728" y1="1298.1982" y2="1298.1982"/><line style="stroke:#666666;stroke-width:1.0;" x1="196.0728" x2="196.0728" y1="1298.1982" y2="1311.1982"/><line style="stroke:#666666;stroke-width:1.0;" x1="155.0728" x2="196.0728" y1="1311.1982" y2="1311.1982"/><polygon fill="#666666" points="165.0728,1307.1982,155.0728,1311.1982,165.0728,1315.1982,161.0728,1311.1982" style="stroke:#666666;stroke-width:1.0;"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186.4878" x="161.0728" y="1293.4561">Fall back to normal validation</text><path d="M359.4878,1277.7324 L359.4878,1317.7324 L522.4878,1317.7324 L522.4878,1287.7324 L512.4878,1277.7324 L359.4878,1277.7324 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M512.4878,1277.7324 L512.4878,1287.7324 L522.4878,1287.7324 L512.4878,1277.7324 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125.7217" x="365.4878" y="1295.3008">Ensures correctness</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142.9302" x="365.4878" y="1310.6113">even if quick path fails</text><!--SRC=[fLPDRnit4BtlhnYWXqg0bO-c3G81Ac1RKQj372TEsXvqeRYp4Y6At99SssgG_vxXSBsxajQ6NUz1M94pZs- -7jTlb2c54rjO2hbPELkP_Dngw-2dsQlPkzaiyur5ZeMeT9XP4sgJD_nqJ8HpzgRUVCjFblqCKooKGLXQbwFpKD2kq1fGunPDy1r_-gl23hvb06TilOz5guSif_natxCEYYI6pkhdmj1lK5ALmeJdGkKYYANm-FzmA2SQuLEbv0R-4beHchA6ytY-HhafhJ81SpZJLcvybdM9yrhhb3LCPEFfznoMqK6kXUhOLk7MNWNhi5torJ8unBJQzRzEPrcNPPF9CUafIkNZosIIPGVaOFHxbnQCOUxPv0mrjLMpCrYZMgt3CEiQZyZv46yCo-ZvKYpjTJVYB1EwJWqmTYUFC3ecVId2cae4O6n082pNSrJokjwlpyRO6vCMKsOzu_0FfUTo7NFvUWoN3aSq4rOAEY0HcqzZZg9XJvhQAj79Vs2umDl0PlFfOCXE7Ol-r9IT8tCwhOVOBsCuTnWfdTAyVltopqV_0AVZ8oGxao-x3k8iQ8rwsERInKAIvRaridAEvf-FIPu4iZ0tAgoPgyUwEOdhmWYJmvPK9GSVHAWwQTNMbZ2ZtAEGQmXE62ya4peWS4yOJRF3NVI9VRWzIUVFfoVfw4bm5RPOhMD_mdqb9Nh_akIfq4g6nd4l4tzIP1ezuAtoGPbLIll2h9oGM5HQxxYn7ChOXpi6GPFtLE_D6AvAskBYVMdpyBGQ-WX125s0XohviGngg_wZmhIZi30aXQM7qbBSkpI855AC8zNmS3IUMyD6X8XGlOET0BYMaT8b4-BXzmVLR24EUe9pEZTb5M9Fl53yTbyNT8d4J8O-_Dwyy_u3rVsLc2GD9l6miR5YiznVsQvWDvrT8tp08AAo3rxuTc7uIAJFr8d6K_9agE4Qc9xskB1cH5f5CL7PgG6s8gH6y0GdLWXO57ILe96xdg1_6yDfNbzqmCeGs-tXbjwJIl9cam6ldi3VX46IgV9XUlyGs_4Amu2R8QtLKVbc-P42cyHAv1Hf2WMrlnFtKxwHzcwTYvWC_UHhPqQIS7Zha3ZWtLNk7p_g4QfT6FJAzBRKI0jUEbM6lH6FAhCtu23AKYlC5-OgaAW9bvEEttLg5hiwVY6yfqz6brIlRc2-d8_kOBPxGYpn2pD-qqAm50EdjcLx7Dbxuoj7iYijtK8o66AvC7YD1bG1_pAPaie1XL3QC_aV]--></g></svg>
