<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="593px" preserveAspectRatio="none" style="width:1100px;height:593px;background:#F0F8FF;" version="1.1" viewBox="0 0 1100 593" width="1100px" zoomAndPan="magnify"><defs/><g><rect fill="#F0F8FF" height="593" style="stroke:none;stroke-width:1.0;" width="1100" x="0" y="0"/><rect fill="#FFFFFF" height="34.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="44.1646" y="106.7988"/><rect fill="#FFFFFF" height="331.1055" style="stroke:#181818;stroke-width:1.0;" width="10" x="587.4365" y="170.4199"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="950.4629" y="324.9727"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="1046.4751" y="199.7305"/><rect fill="none" height="250.4844" style="stroke:#000000;stroke-width:1.5;" width="993.0059" x="10" y="244.041"/><rect fill="none" height="118.2422" style="stroke:#000000;stroke-width:1.5;" width="674.6362" x="20" y="369.2832"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="49" x2="49" y1="67.4883" y2="511.5254"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="299.125" x2="299.125" y1="67.4883" y2="511.5254"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="592.2368" x2="592.2368" y1="67.4883" y2="511.5254"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="954.9199" x2="954.9199" y1="67.4883" y2="511.5254"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1051.0059" x2="1051.0059" y1="67.4883" y2="511.5254"/><rect fill="#DDDDDD" height="30.4883" rx="2.5" ry="2.5" style="stroke:#666666;stroke-width:0.5;" width="38.3291" x="30" y="36"/><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="24.3291" x="37" y="56.5352">P2P</text><rect fill="#DDDDDD" height="30.4883" rx="2.5" ry="2.5" style="stroke:#666666;stroke-width:0.5;" width="38.3291" x="30" y="510.5254"/><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="24.3291" x="37" y="531.0605">P2P</text><rect fill="#DDDDDD" height="30.4883" rx="2.5" ry="2.5" style="stroke:#666666;stroke-width:0.5;" width="51.9326" x="274.125" y="36"/><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37.9326" x="281.125" y="56.5352">Kafka</text><rect fill="#DDDDDD" height="30.4883" rx="2.5" ry="2.5" style="stroke:#666666;stroke-width:0.5;" width="51.9326" x="274.125" y="510.5254"/><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37.9326" x="281.125" y="531.0605">Kafka</text><rect fill="#DDDDDD" height="30.4883" rx="2.5" ry="2.5" style="stroke:#666666;stroke-width:0.5;" width="184.3994" x="500.2368" y="36"/><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="170.3994" x="507.2368" y="56.5352">Subtree Validation Server</text><rect fill="#DDDDDD" height="30.4883" rx="2.5" ry="2.5" style="stroke:#666666;stroke-width:0.5;" width="184.3994" x="500.2368" y="510.5254"/><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="170.3994" x="507.2368" y="531.0605">Subtree Validation Server</text><rect fill="#DDDDDD" height="30.4883" rx="2.5" ry="2.5" style="stroke:#666666;stroke-width:0.5;" width="75.0859" x="917.9199" y="36"/><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61.0859" x="924.9199" y="56.5352">Validator</text><rect fill="#DDDDDD" height="30.4883" rx="2.5" ry="2.5" style="stroke:#666666;stroke-width:0.5;" width="75.0859" x="917.9199" y="510.5254"/><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61.0859" x="924.9199" y="531.0605">Validator</text><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="90.9385" x="1003.0059" y="64.5352">Subtree Store</text><path d="M1033.4751,15 C1033.4751,5 1051.4751,5 1051.4751,5 C1051.4751,5 1069.4751,5 1069.4751,15 L1069.4751,41 C1069.4751,51 1051.4751,51 1051.4751,51 C1051.4751,51 1033.4751,51 1033.4751,41 L1033.4751,15 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M1033.4751,15 C1033.4751,25 1051.4751,25 1051.4751,25 C1051.4751,25 1069.4751,25 1069.4751,15 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="90.9385" x="1003.0059" y="524.0605">Subtree Store</text><path d="M1033.4751,537.0137 C1033.4751,527.0137 1051.4751,527.0137 1051.4751,527.0137 C1051.4751,527.0137 1069.4751,527.0137 1069.4751,537.0137 L1069.4751,563.0137 C1069.4751,573.0137 1051.4751,573.0137 1051.4751,573.0137 C1051.4751,573.0137 1033.4751,573.0137 1033.4751,563.0137 L1033.4751,537.0137 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M1033.4751,537.0137 C1033.4751,547.0137 1051.4751,547.0137 1051.4751,547.0137 C1051.4751,547.0137 1069.4751,547.0137 1069.4751,537.0137 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><rect fill="#FFFFFF" height="34.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="44.1646" y="106.7988"/><rect fill="#FFFFFF" height="331.1055" style="stroke:#181818;stroke-width:1.0;" width="10" x="587.4365" y="170.4199"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="950.4629" y="324.9727"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="1046.4751" y="199.7305"/><line style="stroke:#666666;stroke-width:1.0;" x1="49.1646" x2="96.1646" y1="93.7988" y2="93.7988"/><line style="stroke:#666666;stroke-width:1.0;" x1="96.1646" x2="96.1646" y1="93.7988" y2="106.7988"/><line style="stroke:#666666;stroke-width:1.0;" x1="55.1646" x2="96.1646" y1="106.7988" y2="106.7988"/><polygon fill="#666666" points="65.1646,102.7988,55.1646,106.7988,65.1646,110.7988,61.1646,106.7988" style="stroke:#666666;stroke-width:1.0;"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160.5449" x="61.1646" y="89.0566">handleSubtreeTopic(msg)</text><polygon fill="#666666" points="288.0913,137.1094,298.0913,141.1094,288.0913,145.1094,292.0913,141.1094" style="stroke:#666666;stroke-width:1.0;"/><line style="stroke:#666666;stroke-width:1.0;" x1="49.1646" x2="294.0913" y1="141.1094" y2="141.1094"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221.9268" x="56.1646" y="136.3672">Publish KafkaSubtreeTopicMessage</text><polygon fill="#666666" points="575.4365,166.4199,585.4365,170.4199,575.4365,174.4199,579.4365,170.4199" style="stroke:#666666;stroke-width:1.0;"/><line style="stroke:#666666;stroke-width:1.0;" x1="300.0913" x2="581.4365" y1="170.4199" y2="170.4199"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="238.729" x="307.0913" y="165.6777">subtreesHandler() consumes message</text><polygon fill="#666666" points="1034.4751,195.7305,1044.4751,199.7305,1034.4751,203.7305,1038.4751,199.7305" style="stroke:#666666;stroke-width:1.0;"/><line style="stroke:#666666;stroke-width:1.0;" x1="597.4365" x2="1040.4751" y1="199.7305" y2="199.7305"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="281.0679" x="604.4365" y="194.9883">subtreeStore.Exists(spanCtx, subtreeHash[:])</text><polygon fill="#666666" points="608.4365,225.041,598.4365,229.041,608.4365,233.041,604.4365,229.041" style="stroke:#666666;stroke-width:1.0;"/><line style="stroke:#666666;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="602.4365" x2="1050.4751" y1="229.041" y2="229.041"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117.3618" x="614.4365" y="224.2988">subtreeExists / err</text><path d="M10,244.041 L72.1387,244.041 L72.1387,251.3516 L62.1387,261.3516 L10,261.3516 L10,244.041 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="250.4844" style="stroke:#000000;stroke-width:1.5;" width="993.0059" x="10" y="244.041"/><text fill="#333333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="25" y="257.6094">alt</text><text fill="#333333" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="127.1284" x="87.1387" y="256.6758">[Subtree doesn't exist]</text><line style="stroke:#666666;stroke-width:1.0;" x1="597.4365" x2="639.4365" y1="282.6621" y2="282.6621"/><line style="stroke:#666666;stroke-width:1.0;" x1="639.4365" x2="639.4365" y1="282.6621" y2="295.6621"/><line style="stroke:#666666;stroke-width:1.0;" x1="598.4365" x2="639.4365" y1="295.6621" y2="295.6621"/><polygon fill="#666666" points="608.4365,291.6621,598.4365,295.6621,608.4365,299.6621,604.4365,295.6621" style="stroke:#666666;stroke-width:1.0;"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.0386" x="604.4365" y="277.9199">Obtain a lock on the Subtree</text><polygon fill="#666666" points="938.4629,320.9727,948.4629,324.9727,938.4629,328.9727,942.4629,324.9727" style="stroke:#666666;stroke-width:1.0;"/><line style="stroke:#666666;stroke-width:1.0;" x1="597.4365" x2="944.4629" y1="324.9727" y2="324.9727"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="334.0264" x="604.4365" y="320.2305">ValidateSubtreeInternal(ctx, validateSubtreeMessage)</text><polygon fill="#666666" points="608.4365,350.2832,598.4365,354.2832,608.4365,358.2832,604.4365,354.2832" style="stroke:#666666;stroke-width:1.0;"/><line style="stroke:#666666;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="602.4365" x2="954.4629" y1="354.2832" y2="354.2832"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.2192" x="614.4365" y="349.541">Validation result</text><path d="M20,369.2832 L82.1387,369.2832 L82.1387,376.5938 L72.1387,386.5938 L20,386.5938 L20,369.2832 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="118.2422" style="stroke:#000000;stroke-width:1.5;" width="674.6362" x="20" y="369.2832"/><text fill="#333333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="35" y="382.8516">alt</text><text fill="#333333" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="93.167" x="97.1387" y="381.918">[Invalid subtree]</text><polygon fill="#666666" points="311.0913,403.9043,301.0913,407.9043,311.0913,411.9043,307.0913,407.9043" style="stroke:#666666;stroke-width:1.0;"/><line style="stroke:#666666;stroke-width:1.0;" x1="305.0913" x2="586.4365" y1="407.9043" y2="407.9043"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="263.3452" x="317.0913" y="403.1621">Publish KafkaInvalidSubtreeTopicMessage</text><polygon fill="#666666" points="60.1646,433.2148,50.1646,437.2148,60.1646,441.2148,56.1646,437.2148" style="stroke:#666666;stroke-width:1.0;"/><line style="stroke:#666666;stroke-width:1.0;" x1="54.1646" x2="299.0913" y1="437.2148" y2="437.2148"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214.6333" x="66.1646" y="432.4727">invalidSubtreeHandler() consumes</text><line style="stroke:#666666;stroke-width:1.0;" x1="49.1646" x2="91.1646" y1="466.5254" y2="466.5254"/><line style="stroke:#666666;stroke-width:1.0;" x1="91.1646" x2="91.1646" y1="466.5254" y2="479.5254"/><line style="stroke:#666666;stroke-width:1.0;" x1="50.1646" x2="91.1646" y1="479.5254" y2="479.5254"/><polygon fill="#666666" points="60.1646,475.5254,50.1646,479.5254,60.1646,483.5254,56.1646,479.5254" style="stroke:#666666;stroke-width:1.0;"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212.0244" x="56.1646" y="461.7832">Ban peer that sent invalid subtree</text><text fill="#333333" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="157.5488" x="0" y="583.6816">Last Modified On: 04-Aug-2025</text><!--SRC=[fLHDRnCn4BtxLuo2K1E90089eJrmQ4lK2g962ke5SPXTpoPM73loEA4LuhzZUpzYbvx0qdftFjxRUUFPvPqo1tIuXngRtSRPev5NLbi7BnPl5nyN2y5ZXgGMZzelhF5zolkqiXHqplxiWn_I4k82hgbLXg2sJf9ZQ4CKjGRIj2VZESC7K_b7-2K0BbDsoHMyJwkyJaly5XbB4ofqLlylJTYzQjG1ZVytAY5oYidgtMe2o13kPU0BjZjCeVHK1jV7sZiYk4Uj97fb3Qp9dSWbmFf-NQRtQROBZvO8EzR8T2PS1pTr99qdEOG8vS7yKwooWYqQgQcFVxC7rKptl9a9RBmweQUafGUasYjO7MkjUDkPEN99pBWX8Qb0YvGO2OAM2hX3y4rwivlEucdoSKyC-vvWX4Vn8cm9d6aOMPBr-lE3OizJ3WswyW-lXk0DylPxzICJK_GXDs3-fBoE4ju0EPSBAZk9sWyUa9RON7YWY0nZ0p0K7cdlQe_A08AspGx24VljI9QISyHugDNmE9pGhV7a3Eff4tMUoc3V_rcY6Yi-JqXqZzPPSJPtZZXy_oanqrmoTEn1-Ar9xnywbloPYEUcfOSyDpG3UXoMD9wg0FmzCYCid-bBD70WSg77w873BsVWAMeb8qMyYkED0wUfzU4VPaEhuIkoXwMLgbKauSvKy39sV3gHShvSBkUFOKrcuWy0]--></g></svg>
