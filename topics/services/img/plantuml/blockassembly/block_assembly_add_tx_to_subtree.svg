<svg contentStyleType="text/css" height="778" preserveAspectRatio="none" viewBox="0 0 1448 778" width="1448" xmlns="http://www.w3.org/2000/svg" zoomAndPan="magnify"><path d="m0 0h1448v778h-1448z" fill="#f0f8ff"/><path d="m100.6216 214.041h10v161.8633h-10z" fill="#fff" stroke="#181818"/><path d="m632.1323 375.9043h10v311.3945h-10z" fill="#fff" stroke="#181818"/><path d="m10 84.4883h1432.2446v594.8105h-1432.2446z" fill="none" stroke="#000" stroke-width="1.5"/><path d="m20 167.4199h1412.2446v504.8789h-1412.2446z" fill="none" stroke="#000" stroke-width="1.5"/><path d="m30 321.9727h1319.8452v299.0605h-1319.8452z" fill="none" stroke="#000" stroke-width="1.5"/><path d="m534.2671 449.5254h805.5781v164.5078h-805.5781z" fill="none" stroke="#000" stroke-width="1.5"/><path d="m544.2671 503.1465h785.5781v103.8867h-785.5781z" fill="none" stroke="#000" stroke-width="1.5"/><g stroke-width=".5"><path d="m105 67.4883v628.8105" stroke="#181818" stroke-dasharray="5 5"/><path d="m384.2075 67.4883v628.8105" stroke="#181818" stroke-dasharray="5 5"/><path d="m485.0601 67.4883v628.8105" stroke="#181818" stroke-dasharray="5 5"/><path d="m636.2671 67.4883v628.8105" stroke="#181818" stroke-dasharray="5 5"/><path d="m1133.4526 67.4883v628.8105" stroke="#181818" stroke-dasharray="5 5"/><path d="m1255.9614 67.4883v628.8105" stroke="#181818" stroke-dasharray="5 5"/><path d="m1375.8452 67.4883v628.8105" stroke="#181818" stroke-dasharray="5 5"/><rect fill="#ddd" height="30.4883" rx="2.5" stroke="#666" width="131.2432" x="40" y="36"/></g><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="117.2432" x="47" y="56.5352">SubtreeProcessor</text><rect fill="#ddd" height="30.4883" rx="2.5" stroke="#666" stroke-width=".5" width="131.2432" x="40" y="695.2988"/><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="117.2432" x="47" y="715.834">SubtreeProcessor</text><path d="m358.2075 41h53.8526c5 0 5 13.2441 5 13.2441s0 13.2442-5 13.2442h-53.8526c-5 0-5-13.2442-5-13.2442s0-13.2441 5-13.2441" fill="#e2e2f0" stroke="#181818" stroke-width=".5"/><path d="m412.0601 41c-5 0-5 13.2441-5 13.2441 0 13.2442 5 13.2442 5 13.2442" fill="none" stroke="#181818" stroke-width=".5"/><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43.8525" x="358.2075" y="59.5352">Queue</text><path d="m358.2075 695.2988h53.8526c5 0 5 13.2442 5 13.2442s0 13.2441-5 13.2441h-53.8526c-5 0-5-13.2441-5-13.2441s0-13.2442 5-13.2442" fill="#e2e2f0" stroke="#181818" stroke-width=".5"/><path d="m412.0601 695.2988c-5 0-5 13.2442-5 13.2442 0 13.2441 5 13.2441 5 13.2441" fill="none" stroke="#181818" stroke-width=".5"/><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43.8525" x="358.2075" y="713.834">Queue</text><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111.207" x="427.0601" y="64.5352">Current SubTree</text><ellipse cx="485.6636" cy="35" fill="#ddd" rx="12" ry="12" stroke="#666" stroke-width=".5"/><path d="m473.6636 49h24" stroke="#666" stroke-width=".5"/><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111.207" x="427.0601" y="708.834">Current SubTree</text><ellipse cx="485.6636" cy="727.7871" fill="#ddd" rx="12" ry="12" stroke="#666" stroke-width=".5"/><path d="m473.6636 741.7871h24" stroke="#666" stroke-width=".5"/><rect fill="#ddd" height="30.4883" rx="2.5" stroke="#666" stroke-width=".5" width="165.7305" x="554.2671" y="36"/><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="151.7305" x="561.2671" y="56.5352">Block Assembly Server</text><rect fill="#ddd" height="30.4883" rx="2.5" stroke="#666" stroke-width=".5" width="165.7305" x="554.2671" y="695.2988"/><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="151.7305" x="561.2671" y="715.834">Block Assembly Server</text><rect fill="#ddd" height="30.4883" rx="2.5" stroke="#666" stroke-width=".5" width="100.5088" x="1083.4526" y="36"/><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86.5088" x="1090.4526" y="56.5352">SubtreeStore</text><rect fill="#ddd" height="30.4883" rx="2.5" stroke="#666" stroke-width=".5" width="100.5088" x="1083.4526" y="695.2988"/><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86.5088" x="1090.4526" y="715.834">SubtreeStore</text><rect fill="#ddd" height="30.4883" rx="2.5" stroke="#666" stroke-width=".5" width="125.8838" x="1193.9614" y="36"/><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111.8838" x="1200.9614" y="56.5352">BlockchainClient</text><rect fill="#ddd" height="30.4883" rx="2.5" stroke="#666" stroke-width=".5" width="125.8838" x="1193.9614" y="695.2988"/><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111.8838" x="1200.9614" y="715.834">BlockchainClient</text><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86.3994" x="1329.8452" y="64.5352">Remove Map</text><path d="m1358.0449 15c0-10 18-10 18-10s18 0 18 10v26c0 10-18 10-18 10s-18 0-18-10z" fill="#e2e2f0" stroke="#181818" stroke-width="1.5"/><path d="m1358.0449 15c0 10 18 10 18 10s18 0 18-10" fill="none" stroke="#181818" stroke-width="1.5"/><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86.3994" x="1329.8452" y="708.834">Remove Map</text><path d="m1358.0449 721.7871c0-10 18-10 18-10s18 0 18 10v26c0 10-18 10-18 10s-18 0-18-10z" fill="#e2e2f0" stroke="#181818" stroke-width="1.5"/><path d="m1358.0449 721.7871c0 10 18 10 18 10s18 0 18-10" fill="none" stroke="#181818" stroke-width="1.5"/><path d="m100.6216 214.041h10v161.8633h-10z" fill="#fff" stroke="#181818"/><path d="m632.1323 375.9043h10v311.3945h-10z" fill="#fff" stroke="#181818"/><path d="m10 84.4883h74.4468v7.3105l-10 10h-64.4468z" fill="#eee" stroke="#000" stroke-width="1.5"/><path d="m10 84.4883h1432.2446v594.8105h-1432.2446z" fill="none" stroke="#000" stroke-width="1.5"/><text fill="#333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.4468" x="25" y="98.0566">loop</text><path d="m116.6216 119.1094-10 4 10 4-4-4z" fill="#666" stroke="#666"/><path d="m110.6216 123.1094h273.5122" stroke="#666"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="255.5122" x="122.6216" y="118.3672">txReq = queue.dequeue(validFromMillis)</text><path d="m1364.0449 148.4199 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m105.6216 152.4199h1264.4233" stroke="#666"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="152.9595" x="112.6216" y="147.6777">Exists(txReq.node.Hash)</text><path d="m20 167.4199h62.1387v7.3106l-10 10h-52.1387z" fill="#eee" stroke="#000" stroke-width="1.5"/><path d="m20 167.4199h1412.2446v504.8789h-1412.2446z" fill="none" stroke="#000" stroke-width="1.5"/><text fill="#333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="35" y="180.9883">alt</text><text fill="#333" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="125.1143" x="97.1387" y="180.0547">[if not in RemoveMap]</text><path d="m105.6216 201.041h47" stroke="#666"/><path d="m152.6216 201.041v13" stroke="#666"/><path d="m111.6216 214.041h41" stroke="#666"/><path d="m121.6216 210.041-10 4 10 4-4-4z" fill="#666" stroke="#666"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174.897" x="117.6216" y="196.2988">addNode(txReq.node, false)</text><path d="m473.6636 244.3516 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m110.6216 248.3516h369.042" stroke="#666"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186.7925" x="117.6216" y="243.6094">AddSubtreeNode(txReq.node)</text><path d="m473.6636 273.6621 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m110.6216 277.6621h369.042" stroke="#666"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79.2314" x="117.6216" y="272.9199">IsComplete()</text><path d="m121.6216 302.9727-10 4 10 4-4-4z" fill="#666" stroke="#666"/><path d="m115.6216 306.9727h369.042" stroke="#666" stroke-dasharray="2 2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="70.1226" x="127.6216" y="302.2305">true / false</text><path d="m30 321.9727h62.1387v7.3105l-10 10h-52.1387z" fill="#eee" stroke="#000" stroke-width="1.5"/><path d="m30 321.9727h1319.8452v299.0605h-1319.8452z" fill="none" stroke="#000" stroke-width="1.5"/><text fill="#333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="45" y="335.541">alt</text><text fill="#333" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="133.853" x="107.1387" y="334.6074">[if Subtree is Complete]</text><path d="m620.1323 371.9043 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m105.6216 375.9043h520.5107" stroke="#666"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128.064" x="112.6216" y="355.8516">Send currentSubtree</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160.145" x="112.6216" y="371.1621">through newSubtreeChan</text><path d="m1121.707 401.2148 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m642.1323 405.2148h485.5747" stroke="#666"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="206.229" x="649.1323" y="400.4727">Exists(ctx, subtree.RootHash()[:])</text><path d="m653.1323 430.5254-10 4 10 4-4-4z" fill="#666" stroke="#666"/><path d="m647.1323 434.5254h485.5747" stroke="#666" stroke-dasharray="2 2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114.0547" x="659.1323" y="429.7832">Exists / not exists</text><path d="m534.2671 449.5254h62.1387v7.3105l-10 10h-52.1387z" fill="#eee" stroke="#000" stroke-width="1.5"/><path d="m534.2671 449.5254h805.5781v164.5078h-805.5781z" fill="none" stroke="#000" stroke-width="1.5"/><text fill="#333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="549.2671" y="463.0938">alt</text><text fill="#333" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="146.8242" x="611.4058" y="462.1602">[if Subtree does not exist]</text><path d="m1121.707 484.1465 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m642.1323 488.1465h485.5747" stroke="#666"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="467.5747" x="649.1323" y="483.4043">Set(ctx, subtree.RootHash()[:], subtreeBytes, options.WithTTL(subtreeTTL))</text><path d="m544.2671 503.1465h62.1387v7.3105l-10 10h-52.1387z" fill="#eee" stroke="#000" stroke-width="1.5"/><path d="m544.2671 503.1465h785.5781v103.8867h-785.5781z" fill="none" stroke="#000" stroke-width="1.5"/><text fill="#333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="559.2671" y="516.7148">alt</text><text fill="#333" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="65.1299" x="621.4058" y="515.7813">[if Set fails]</text><path d="m642.1323 541.7676h42" stroke="#666"/><path d="m684.1323 541.7676v13" stroke="#666"/><path d="m643.1323 554.7676h41" stroke="#666"/><path d="m653.1323 550.7676-10 4 10 4-4-4z" fill="#666" stroke="#666"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="247.019" x="649.1323" y="537.0254">Add to subtreeRetryChan for later retry</text><path d="m544.2671 563.7676h785.5781" stroke="#000" stroke-dasharray="2 2"/><text fill="#333" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="92.2808" x="549.2671" y="574.4023">[if Set succeeds]</text><path d="m1244.9033 595.0332 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m642.1323 599.0332h608.771" stroke="#666"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="520.0762" x="649.1323" y="594.291">SendNotification(ctx, &amp;blockchain.Notification{Type: NotificationType_Subtree, ...})</text><path d="m20 629.0332h1412.2446" stroke="#000" stroke-dasharray="2 2"/><text fill="#333" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="102.7813" x="25" y="639.668">[if in RemoveMap]</text><path d="m1364.0449 660.2988 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m105.6216 664.2988h1264.4233" stroke="#666"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156.1523" x="112.6216" y="659.5566">Delete(txReq.node.Hash)</text><text fill="#333" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="155.4346" y="768.4551">Last Modified On: 24-Feb-2025</text></svg>
