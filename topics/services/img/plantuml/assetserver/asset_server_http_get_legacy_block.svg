<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="654px" preserveAspectRatio="none" style="width:1224px;height:654px;background:#F0F8FF;" version="1.1" viewBox="0 0 1224 654" width="1224px" zoomAndPan="magnify"><defs/><g><rect fill="#F0F8FF" height="654" style="stroke:none;stroke-width:1;" width="1224" x="0" y="0"/><g><title>HTTP Server</title><rect fill="#FFFFFF" height="418.9688" style="stroke:#181818;stroke-width:1;" width="10" x="426.8599" y="84.2871"/></g><g><title>Repository</title><rect fill="#FFFFFF" height="360.3477" style="stroke:#181818;stroke-width:1;" width="10" x="687.395" y="113.5977"/></g><g><title>BlockchainClient</title><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1;" width="10" x="837.4893" y="142.9082"/></g><g><title>Block Persister Store</title><rect fill="#FFFFFF" height="95.2422" style="stroke:#181818;stroke-width:1;" width="10" x="1093.376" y="276.4609"/></g><rect fill="none" height="207.7949" style="stroke:#000000;stroke-width:1.5;" width="622.0688" x="596" y="237.8398"/><g><title>HTTP Client</title><rect fill="#000000" fill-opacity="0.00000" height="534.2109" width="8" x="105.833" y="52.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="109" x2="109" y1="52.9766" y2="587.1875"/></g><g><title>HTTP Server</title><rect fill="#000000" fill-opacity="0.00000" height="534.2109" width="8" x="427.8599" y="52.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="431.5986" x2="431.5986" y1="52.9766" y2="587.1875"/></g><g><title>Repository</title><rect fill="#000000" fill-opacity="0.00000" height="534.2109" width="8" x="688.395" y="52.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="692.332" x2="692.332" y1="52.9766" y2="587.1875"/></g><g><title>BlockchainClient</title><rect fill="#000000" fill-opacity="0.00000" height="534.2109" width="8" x="838.4893" y="52.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="841.5474" x2="841.5474" y1="52.9766" y2="587.1875"/></g><g><title>Block Persister Store</title><rect fill="#000000" fill-opacity="0.00000" height="534.2109" width="8" x="1094.376" y="52.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1098.292" x2="1098.292" y1="52.9766" y2="587.1875"/></g><g class="participant participant-head" data-participant="Client"><rect fill="#DDDDDD" height="30.4883" rx="2.5" ry="2.5" style="stroke:#666666;stroke-width:0.5;" width="93.666" x="63" y="21.4883"/><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79.666" x="70" y="42.0234">HTTP Client</text></g><g class="participant participant-tail" data-participant="Client"><rect fill="#DDDDDD" height="30.4883" rx="2.5" ry="2.5" style="stroke:#666666;stroke-width:0.5;" width="93.666" x="63" y="586.1875"/><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79.666" x="70" y="606.7227">HTTP Client</text></g><g class="participant participant-head" data-participant="HTTPServer"><rect fill="#DDDDDD" height="46.9766" rx="2.5" ry="2.5" style="stroke:#666666;stroke-width:0.5;" width="128.5225" x="367.5986" y="5"/><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.0039" x="390.8579" y="25.5352">HTTP Server</text><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="114.5225" x="374.5986" y="42.0234">(GetLegacyBlock)</text></g><g class="participant participant-tail" data-participant="HTTPServer"><rect fill="#DDDDDD" height="46.9766" rx="2.5" ry="2.5" style="stroke:#666666;stroke-width:0.5;" width="128.5225" x="367.5986" y="586.1875"/><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.0039" x="390.8579" y="606.7227">HTTP Server</text><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="114.5225" x="374.5986" y="623.2109">(GetLegacyBlock)</text></g><g class="participant participant-head" data-participant="Repo"><rect fill="#DDDDDD" height="30.4883" rx="2.5" ry="2.5" style="stroke:#666666;stroke-width:0.5;" width="86.126" x="649.332" y="21.4883"/><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72.126" x="656.332" y="42.0234">Repository</text></g><g class="participant participant-tail" data-participant="Repo"><rect fill="#DDDDDD" height="30.4883" rx="2.5" ry="2.5" style="stroke:#666666;stroke-width:0.5;" width="86.126" x="649.332" y="586.1875"/><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72.126" x="656.332" y="606.7227">Repository</text></g><g class="participant participant-head" data-participant="BC"><rect fill="#DDDDDD" height="30.4883" rx="2.5" ry="2.5" style="stroke:#666666;stroke-width:0.5;" width="125.8838" x="779.5474" y="21.4883"/><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111.8838" x="786.5474" y="42.0234">BlockchainClient</text></g><g class="participant participant-tail" data-participant="BC"><rect fill="#DDDDDD" height="30.4883" rx="2.5" ry="2.5" style="stroke:#666666;stroke-width:0.5;" width="125.8838" x="779.5474" y="586.1875"/><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111.8838" x="786.5474" y="606.7227">BlockchainClient</text></g><g class="participant participant-head" data-participant="BPS"><rect fill="#DDDDDD" height="30.4883" rx="2.5" ry="2.5" style="stroke:#666666;stroke-width:0.5;" width="152.168" x="1022.292" y="21.4883"/><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="138.168" x="1029.292" y="42.0234">Block Persister Store</text></g><g class="participant participant-tail" data-participant="BPS"><rect fill="#DDDDDD" height="30.4883" rx="2.5" ry="2.5" style="stroke:#666666;stroke-width:0.5;" width="152.168" x="1022.292" y="586.1875"/><text fill="#333333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="138.168" x="1029.292" y="606.7227">Block Persister Store</text></g><g><title>HTTP Server</title><rect fill="#FFFFFF" height="418.9688" style="stroke:#181818;stroke-width:1;" width="10" x="426.8599" y="84.2871"/></g><g><title>Repository</title><rect fill="#FFFFFF" height="360.3477" style="stroke:#181818;stroke-width:1;" width="10" x="687.395" y="113.5977"/></g><g><title>BlockchainClient</title><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1;" width="10" x="837.4893" y="142.9082"/></g><g><title>Block Persister Store</title><rect fill="#FFFFFF" height="95.2422" style="stroke:#181818;stroke-width:1;" width="10" x="1093.376" y="276.4609"/></g><g class="message" data-participant-1="Client" data-participant-2="HTTPServer"><polygon fill="#666666" points="414.8599,80.2871,424.8599,84.2871,414.8599,88.2871,418.8599,84.2871" style="stroke:#666666;stroke-width:1;"/><line style="stroke:#666666;stroke-width:1;" x1="109.833" x2="420.8599" y1="84.2871" y2="84.2871"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156.8823" x="116.833" y="79.5449">GET /block_legacy/:hash</text></g><g class="message" data-participant-1="HTTPServer" data-participant-2="Repo"><polygon fill="#666666" points="675.395,109.5977,685.395,113.5977,675.395,117.5977,679.395,113.5977" style="stroke:#666666;stroke-width:1;"/><line style="stroke:#666666;stroke-width:1;" x1="436.8599" x2="681.395" y1="113.5977" y2="113.5977"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207.3906" x="443.8599" y="108.8555">GetLegacyBlockReader(ctx, hash)</text></g><g class="message" data-participant-1="Repo" data-participant-2="BC"><polygon fill="#666666" points="825.4893,138.9082,835.4893,142.9082,825.4893,146.9082,829.4893,142.9082" style="stroke:#666666;stroke-width:1;"/><line style="stroke:#666666;stroke-width:1;" x1="697.395" x2="831.4893" y1="142.9082" y2="142.9082"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121.0942" x="704.395" y="138.166">GetBlock(ctx, hash)</text></g><g class="message" data-participant-1="BC" data-participant-2="Repo"><polygon fill="#666666" points="708.395,168.2188,698.395,172.2188,708.395,176.2188,704.395,172.2188" style="stroke:#666666;stroke-width:1;"/><line style="stroke:#666666;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="702.395" x2="841.4893" y1="172.2188" y2="172.2188"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76.8955" x="714.395" y="167.4766">model.Block</text></g><path d="M610,185.2188 L610,225.2188 L774,225.2188 L774,195.2188 L764,185.2188 L610,185.2188" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M764,185.2188 L764,195.2188 L774,195.2188 L764,185.2188" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143.4824" x="616" y="202.7871">Extract subtree hashes</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68.5166" x="616" y="218.0977">from block</text><path d="M596,237.8398 L670.4468,237.8398 L670.4468,245.1504 L660.4468,255.1504 L596,255.1504 L596,237.8398" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="207.7949" style="stroke:#000000;stroke-width:1.5;" width="622.0688" x="596" y="237.8398"/><text fill="#333333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.4468" x="611" y="251.4082">loop</text><text fill="#333333" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="149.8213" x="685.4468" y="250.4746">[for each subtree in block]</text><g class="message" data-participant-1="Repo" data-participant-2="BPS"><polygon fill="#666666" points="1081.376,272.4609,1091.376,276.4609,1081.376,280.4609,1085.376,276.4609" style="stroke:#666666;stroke-width:1;"/><line style="stroke:#666666;stroke-width:1;" x1="697.395" x2="1087.376" y1="276.4609" y2="276.4609"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="376.981" x="704.395" y="271.7188">GetSubtreeDataReaderFromBlockPersister(ctx, subtreeHash)</text></g><path d="M988,289.4609 L988,344.4609 L1208,344.4609 L1208,299.4609 L1198,289.4609 L988,289.4609" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1198,289.4609 L1198,299.4609 L1208,299.4609 L1198,289.4609" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="199.0688" x="994" y="307.0293">Retrieves enriched subtree data</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161.3828" x="994" y="322.3398">with transaction payloads</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137.4966" x="994" y="337.6504">(FileTypeSubtreeData)</text><g class="message" data-participant-1="BPS" data-participant-2="Repo"><polygon fill="#666666" points="708.395,367.7031,698.395,371.7031,708.395,375.7031,704.395,371.7031" style="stroke:#666666;stroke-width:1;"/><line style="stroke:#666666;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="702.395" x2="1097.376" y1="371.7031" y2="371.7031"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.1655" x="714.395" y="366.9609">io.ReadCloser (Subtree Data)</text></g><path d="M606,384.7031 L606,439.7031 L776,439.7031 L776,394.7031 L766,384.7031 L606,384.7031" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M766,384.7031 L766,394.7031 L776,394.7031 L766,384.7031" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.8213" x="612" y="402.2715">Skip 4-byte header</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149.938" x="612" y="417.582">Stream transaction data</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.3687" x="612" y="432.8926">to legacy block format</text><g class="message" data-participant-1="Repo" data-participant-2="HTTPServer"><polygon fill="#666666" points="447.8599,469.9453,437.8599,473.9453,447.8599,477.9453,443.8599,473.9453" style="stroke:#666666;stroke-width:1;"/><line style="stroke:#666666;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="441.8599" x2="691.395" y1="473.9453" y2="473.9453"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="226.5352" x="453.8599" y="469.2031">io.PipeReader (Legacy Block Stream)</text></g><g class="message" data-participant-1="HTTPServer" data-participant-2="Client"><polygon fill="#666666" points="120.833,499.2559,110.833,503.2559,120.833,507.2559,116.833,503.2559" style="stroke:#666666;stroke-width:1;"/><line style="stroke:#666666;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="114.833" x2="430.8599" y1="503.2559" y2="503.2559"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="293.0269" x="126.833" y="498.5137">Binary Stream (Legacy Bitcoin Protocol Format)</text></g><path d="M5,516.2559 L5,571.2559 L215,571.2559 L215,526.2559 L205,516.2559 L5,516.2559" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M205,516.2559 L205,526.2559 L215,526.2559 L205,516.2559" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176.979" x="11" y="533.8242">Receives block in traditional</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.793" x="11" y="549.1348">Bitcoin protocol format</text><text fill="#333333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="189.6997" x="11" y="564.4453">compatible with legacy clients</text><text fill="#333333" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="153.7305" x="0" y="644.832">Last Modified On: 3-July-2025</text><!--SRC=[fPHDRnen48Rl_XKZggeWbQHIgwZYq0Cacno2YbYEI9Nn3i72U5Qsyx6g-jyxjZTWefnQ7z1-lFFudV6x-BsshNJo01kfzW-E7cqp8qCEFbHVgkzL9VnHqU1MFffGaGszv6jQXKGwHy_zowkqXFW4rxZL5c53ha7dOSjlfJ601WzeWo_g-LQ73duBW6bIdxFuwLkNrsc9FwAWA7ReoFmlXd-3LhgLDlmRgWGCxbQh1SoCvXO787r_-OwcHlU4Rcs7jnZkyK6gRcf8xKUfAYgouBnoYIrv7SXrIHPlpmM9eNPIsyB3TFQE21PyIDe7T50p4BDoKGkHAs7yex014xYzMS7b9fR-CidlvMGd_Kv85VIJ35YQBWeP4sr6m5cZIvGyvg4ABvyXSaOdK6fBf2gkdivoRQfwLy_ziMXyskb03PgBL20QB7N24bzGDDPhRrw2OmNunqrmY8cDVcstZlXhIGXXYDgKPsRjZafj-_V0w-XsKMUxTLPToo1pgnK3awNZu7CpFUukzHHH9xzy6l71oNEcBp4uZK_e-KDoMksmENfgUBkrVTPX1zoMzP55bZFU6P8DjpMijC5LrsBXBsyRsSKCDLr4tpD3dZSUzd8uwSl1zaRVkEr9zLwty6sywVZvBerYRMk6yRTNUipM0q5ELvvjdFf11e6sUKt4srooqOLkCGyPXZbYa3EUjncL8SZXAWFAm3xo4vXgArtNrvrWEYZYuruu2gJuBwTAhiwuHVgBa1t1IrIeuv7bjXZ6lJSwTYxDshxkqBxkaFjUMqM7LWQzCGZfLFlXgCJr74tS1XPJ_8xlfGymfqPlDKVYfvt0Hnug3WTDCvxFv-EErs0a_W80]--></g></svg>
