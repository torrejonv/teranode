<svg contentStyleType="text/css" height="4069" preserveAspectRatio="none" viewBox="0 0 1638 4069" width="1638" xmlns="http://www.w3.org/2000/svg" zoomAndPan="magnify"><path d="m0 0h1638v4069h-1638z" fill="#f0f8ff"/><text fill="#333" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="205.3447" x="717.9312" y="28.5352">UTXO Store Operations Flow</text><g fill="#fff"><path d="m369.8203 3429.7676h10v227.7949h-10z" stroke="#666"/><path d="m369.8203 3686.873h10v259.1055h-10z" stroke="#666"/><path d="m987.8652 177.0859h10v169.1738h-10z" stroke="#666"/><path d="m987.8652 375.5703h10v125.8633h-10z" stroke="#666"/><path d="m987.8652 562.0547h10v211.4844h-10z" stroke="#666"/><path d="m987.8652 802.8496h10v169.1738h-10z" stroke="#666"/><path d="m987.8652 1032.6445h10v125.8633h-10z" stroke="#666"/><path d="m987.8652 1187.8184h10v110.5527h-10z" stroke="#666"/><path d="m987.8652 1358.9922h10v184.4844h-10z" stroke="#666"/><path d="m987.8652 1572.7871h10v110.5527h-10z" stroke="#666"/><path d="m987.8652 1743.9609h10v168.1738h-10z" stroke="#666"/><path d="m987.8652 1941.4453h10v152.8633h-10z" stroke="#666"/><path d="m987.8652 2154.9297h10v152.8633h-10z" stroke="#666"/><path d="m987.8652 2337.1035h10v110.5527h-10z" stroke="#666"/><path d="m987.8652 2476.9668h10v152.8633h-10z" stroke="#666"/><path d="m987.8652 2690.4512h10v200.4844h-10z" stroke="#666"/><path d="m987.8652 2951.5566h10v110.5527h-10z" stroke="#666"/><path d="m987.8652 3091.4199h10v169.1738h-10z" stroke="#666"/><path d="m987.8652 3517.6992h10v110.5527h-10z" stroke="#666"/><path d="m1307.4478 3289.9043h10v110.5527h-10z" stroke="#666"/><path d="m1381.855 633.6758h10v110.5527h-10z" stroke="#666"/><path d="m1381.855 832.1602h10v110.5527h-10z" stroke="#666"/></g><path d="m10 138.4648h1273.6455v370.9688h-1273.6455z" fill="none" stroke="#000" stroke-width="1.5"/><path d="m10 523.4336h1622.207v456.5898h-1622.207z" fill="none" stroke="#000" stroke-width="1.5"/><path d="m95.0859 994.0234h1100.7695v312.3477h-1100.7695z" fill="none" stroke="#000" stroke-width="1.5"/><path d="m599.188 1320.3711h684.4575v370.9688h-684.4575z" fill="none" stroke="#000" stroke-width="1.5"/><path d="m695.5669 1705.3398h532.8872v396.9688h-532.8872z" fill="none" stroke="#000" stroke-width="1.5"/><path d="m10 2116.3086h1182.8149v521.5215h-1182.8149z" fill="none" stroke="#000" stroke-width="1.5"/><path d="m10 2651.8301h1283.6455v247.1055h-1283.6455z" fill="none" stroke="#000" stroke-width="1.5"/><path d="m924.8188 2786.6934h358.8267v75.9316h-358.8267z" fill="none" stroke="#000" stroke-width="1.5"/><path d="m95.0859 2912.9355h1416.4912v1041.043h-1416.4912z" fill="none" stroke="#000" stroke-width="1.5"/><path d="m295.7568 3783.1152h1055.4932v134.5527h-1055.4932z" fill="none" stroke="#000" stroke-width="1.5"/><path d="m57 121.4648v3849.5137" stroke="#666" stroke-dasharray="5 5" stroke-width=".5"/><path d="m164.0859 121.4648v3849.5137" stroke="#666" stroke-dasharray="5 5" stroke-width=".5"/><path d="m374.7568 121.4648v3849.5137" stroke="#666" stroke-dasharray="5 5" stroke-width=".5"/><path d="m652.188 121.4648v3849.5137" stroke="#666" stroke-dasharray="5 5" stroke-width=".5"/><path d="m735.5669 121.4648v3849.5137" stroke="#666" stroke-dasharray="5 5" stroke-width=".5"/><path d="m992.8188 121.4648v3849.5137" stroke="#666" stroke-dasharray="5 5" stroke-width=".5"/><path d="m1228.2627 121.4648v3849.5137" stroke="#666" stroke-dasharray="5 5" stroke-width=".5"/><path d="m1311.6455 121.4648v3849.5137" stroke="#666" stroke-dasharray="5 5" stroke-width=".5"/><path d="m1386.25 121.4648v3849.5137" stroke="#666" stroke-dasharray="5 5" stroke-width=".5"/><rect fill="#b8d4e3" height="46.9766" rx="2.5" stroke="#666" stroke-width=".5" width="75.0859" x="20" y="73.4883"/><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61.0859" x="27" y="94.0234">Validator</text><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47.332" x="33.877" y="110.5117">Service</text><rect fill="#b8d4e3" height="46.9766" rx="2.5" stroke="#666" stroke-width=".5" width="75.0859" x="20" y="3969.9785"/><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61.0859" x="27" y="3990.5137">Validator</text><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47.332" x="33.877" y="4007.002">Service</text><rect fill="#b8d4e3" height="46.9766" rx="2.5" stroke="#666" stroke-width=".5" width="119.458" x="105.0859" y="73.4883"/><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105.458" x="112.0859" y="94.0234">Block Assembly</text><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47.332" x="141.1489" y="110.5117">Service</text><rect fill="#b8d4e3" height="46.9766" rx="2.5" stroke="#666" stroke-width=".5" width="119.458" x="105.0859" y="3969.9785"/><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105.458" x="112.0859" y="3990.5137">Block Assembly</text><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47.332" x="141.1489" y="4007.002">Service</text><rect fill="#d4b8e3" height="46.9766" rx="2.5" stroke="#666" stroke-width=".5" width="138.127" x="305.7568" y="73.4883"/><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="124.127" x="312.7568" y="94.0234">Subtree Validation</text><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47.332" x="351.1543" y="110.5117">Service</text><rect fill="#d4b8e3" height="46.9766" rx="2.5" stroke="#666" stroke-width=".5" width="138.127" x="305.7568" y="3969.9785"/><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="124.127" x="312.7568" y="3990.5137">Subtree Validation</text><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47.332" x="351.1543" y="4007.002">Service</text><rect fill="#b8d4e3" height="46.9766" rx="2.5" stroke="#666" stroke-width=".5" width="86.3789" x="609.188" y="73.4883"/><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72.3789" x="616.188" y="94.0234">Blockchain</text><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47.332" x="628.7114" y="110.5117">Service</text><rect fill="#b8d4e3" height="46.9766" rx="2.5" stroke="#666" stroke-width=".5" width="86.3789" x="609.188" y="3969.9785"/><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72.3789" x="616.188" y="3990.5137">Blockchain</text><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47.332" x="628.7114" y="4007.002">Service</text><rect fill="#b8d4e3" height="46.9766" rx="2.5" stroke="#666" stroke-width=".5" width="61.332" x="705.5669" y="73.4883"/><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32.4707" x="719.9976" y="94.0234">Alert</text><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47.332" x="712.5669" y="110.5117">Service</text><rect fill="#b8d4e3" height="46.9766" rx="2.5" stroke="#666" stroke-width=".5" width="61.332" x="705.5669" y="3969.9785"/><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32.4707" x="719.9976" y="3990.5137">Alert</text><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47.332" x="712.5669" y="4007.002">Service</text><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77.5264" x="951.1021" y="102.0234">UTXO Store</text><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110.0928" x="934.8188" y="118.5117">(Aerospike/SQL)</text><path d="m974.8652 52.4883c0-10 18-10 18-10s18 0 18 10v26c0 10-18 10-18 10s-18 0-18-10z" fill="#c8e6c9" stroke="#181818" stroke-width="1.5"/><path d="m974.8652 52.4883c0 10 18 10 18 10s18 0 18-10" fill="none" stroke="#181818" stroke-width="1.5"/><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77.5264" x="951.1021" y="3983.5137">UTXO Store</text><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110.0928" x="934.8188" y="4000.002">(Aerospike/SQL)</text><path d="m974.8652 4012.9551c0-10 18-10 18-10s18 0 18 10v26c0 10-18 10-18 10s-18 0-18-10z" fill="#c8e6c9" stroke="#181818" stroke-width="1.5"/><path d="m974.8652 4012.9551c0 10 18 10 18 10s18 0 18-10" fill="none" stroke="#181818" stroke-width="1.5"/><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84.3828" x="1183.2627" y="102.0234">TX Metadata</text><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="34.9043" x="1208.002" y="118.5117">Store</text><path d="m1210.4541 52.4883c0-10 18-10 18-10s18 0 18 10v26c0 10-18 10-18 10s-18 0-18-10z" fill="#ffe0b2" stroke="#181818" stroke-width="1.5"/><path d="m1210.4541 52.4883c0 10 18 10 18 10s18 0 18-10" fill="none" stroke="#181818" stroke-width="1.5"/><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84.3828" x="1183.2627" y="3983.5137">TX Metadata</text><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="34.9043" x="1208.002" y="4000.002">Store</text><path d="m1210.4541 4012.9551c0-10 18-10 18-10s18 0 18 10v26c0 10-18 10-18 10s-18 0-18-10z" fill="#ffe0b2" stroke="#181818" stroke-width="1.5"/><path d="m1210.4541 4012.9551c0 10 18 10 18 10s18 0 18-10" fill="none" stroke="#181818" stroke-width="1.5"/><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.6045" x="1283.6455" y="102.0234">Subtree</text><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="34.9043" x="1291.9956" y="118.5117">Store</text><path d="m1294.4478 52.4883c0-10 18-10 18-10s18 0 18 10v26c0 10-18 10-18 10s-18 0-18-10z" fill="#e1bee7" stroke="#181818" stroke-width="1.5"/><path d="m1294.4478 52.4883c0 10 18 10 18 10s18 0 18-10" fill="none" stroke="#181818" stroke-width="1.5"/><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.6045" x="1283.6455" y="3983.5137">Subtree</text><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="34.9043" x="1291.9956" y="4000.002">Store</text><path d="m1294.4478 4012.9551c0-10 18-10 18-10s18 0 18 10v26c0 10-18 10-18 10s-18 0-18-10z" fill="#e1bee7" stroke="#181818" stroke-width="1.5"/><path d="m1294.4478 4012.9551c0 10 18 10 18 10s18 0 18-10" fill="none" stroke="#181818" stroke-width="1.5"/><rect fill="#ffcdd2" height="46.9766" rx="2.5" stroke="#666" stroke-width=".5" width="71.21" x="1351.25" y="73.4883"/><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="52.623" x="1360.5435" y="94.0234">Conflict</text><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.21" x="1358.25" y="110.5117">Resolver</text><rect fill="#ffcdd2" height="46.9766" rx="2.5" stroke="#666" stroke-width=".5" width="71.21" x="1351.25" y="3969.9785"/><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="52.623" x="1360.5435" y="3990.5137">Conflict</text><text fill="#333" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.21" x="1358.25" y="4007.002">Resolver</text><path d="m369.8203 3429.7676h10v227.7949h-10z" fill="#fff" stroke="#666"/><path d="m369.8203 3686.873h10v259.1055h-10z" fill="#fff" stroke="#666"/><path d="m987.8652 177.0859h10v169.1738h-10z" fill="#fff" stroke="#666"/><path d="m987.8652 375.5703h10v125.8633h-10z" fill="#fff" stroke="#666"/><path d="m987.8652 562.0547h10v211.4844h-10z" fill="#fff" stroke="#666"/><path d="m987.8652 802.8496h10v169.1738h-10z" fill="#fff" stroke="#666"/><path d="m987.8652 1032.6445h10v125.8633h-10z" fill="#fff" stroke="#666"/><path d="m987.8652 1187.8184h10v110.5527h-10z" fill="#fff" stroke="#666"/><path d="m987.8652 1358.9922h10v184.4844h-10z" fill="#fff" stroke="#666"/><path d="m987.8652 1572.7871h10v110.5527h-10z" fill="#fff" stroke="#666"/><path d="m987.8652 1743.9609h10v168.1738h-10z" fill="#fff" stroke="#666"/><path d="m987.8652 1941.4453h10v152.8633h-10z" fill="#fff" stroke="#666"/><path d="m987.8652 2154.9297h10v152.8633h-10z" fill="#fff" stroke="#666"/><path d="m987.8652 2337.1035h10v110.5527h-10z" fill="#fff" stroke="#666"/><path d="m987.8652 2476.9668h10v152.8633h-10z" fill="#fff" stroke="#666"/><path d="m987.8652 2690.4512h10v200.4844h-10z" fill="#fff" stroke="#666"/><path d="m987.8652 2951.5566h10v110.5527h-10z" fill="#fff" stroke="#666"/><path d="m987.8652 3091.4199h10v169.1738h-10z" fill="#fff" stroke="#666"/><path d="m987.8652 3517.6992h10v110.5527h-10z" fill="#fff" stroke="#666"/><path d="m1307.4478 3289.9043h10v110.5527h-10z" fill="#fff" stroke="#666"/><path d="m1381.855 633.6758h10v110.5527h-10z" fill="#fff" stroke="#666"/><path d="m1381.855 832.1602h10v110.5527h-10z" fill="#fff" stroke="#666"/><path d="m10 138.4648h313.582v7.3106l-10 10h-303.582z" fill="#eee" stroke="#000" stroke-width="1.5"/><path d="m10 138.4648h1273.6455v370.9688h-1273.6455z" fill="none" stroke="#000" stroke-width="1.5"/><text fill="#333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="268.582" x="25" y="152.0332">Transaction Validation &amp; UTXO Creation</text><path d="m975.8652 173.0859 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m57.543 177.0859h924.3222" stroke="#666" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.1294" x="64.543" y="172.3438">Create(tx, blockHeight)</text><path d="m1002 190.0859v71h212v-61l-10-10z" fill="#fffacd" stroke="#666" stroke-width=".5"/><path d="m1204 190.0859v10h10z" fill="#fffacd" stroke="#666" stroke-width=".5"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191.5596" x="1008" y="207.6543">Creates UTXOs for all outputs:</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142.9619" x="1008" y="222.9648">- Stores output scripts</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.7065" x="1008" y="238.2754">- Marks as unspent</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154.2734" x="1008" y="253.5859">- Sets coinbase maturity</text><path d="m1216.4541 283.6387 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m997.8652 287.6387h224.5889" stroke="#666" stroke-dasharray="2 2" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.3481" x="1004.8652" y="282.8965">Store metadata</text><path d="m1008.8652 312.9492-10 4 10 4-4-4z" fill="#666" stroke="#666"/><path d="m1002.8652 316.9492h224.5889" stroke="#666" stroke-dasharray="2 2" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102.2163" x="1014.8652" y="312.207">Metadata stored</text><path d="m68.543 342.2598-10 4 10 4-4-4z" fill="#666" stroke="#666"/><path d="m62.543 346.2598h929.3222" stroke="#666" stroke-dasharray="2 2" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.4922" x="74.543" y="341.5176">meta.Data</text><path d="m975.8652 371.5703 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m57.543 375.5703h924.3222" stroke="#666" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.3115" x="64.543" y="370.8281">Spend(tx, ignoreFlags)</text><path d="m1002 388.5703v86h243v-76l-10-10z" fill="#fffacd" stroke="#666" stroke-width=".5"/><path d="m1235 388.5703v10h10z" fill="#fffacd" stroke="#666" stroke-width=".5"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94.7007" x="1008" y="406.1387">For each input:</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143.6284" x="1008" y="421.4492">- Check if UTXO exists</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161.916" x="1008" y="436.7598">- Verify not already spent</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="222.4409" x="1008" y="452.0703">- Mark as spent with SpendingData</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125.9058" x="1008" y="467.3809">- Track spending tx</text><path d="m68.543 497.4336-10 4 10 4-4-4z" fill="#666" stroke="#666"/><path d="m62.543 501.4336h929.3222" stroke="#666" stroke-dasharray="2 2" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100.0137" x="74.543" y="496.6914">[]*Spend results</text><path d="m10 523.4336h255.0757v7.3105l-10 10h-245.0757z" fill="#eee" stroke="#000" stroke-width="1.5"/><path d="m10 523.4336h1622.207v456.5898h-1622.207z" fill="none" stroke="#000" stroke-width="1.5"/><text fill="#333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="210.0757" x="25" y="537.002">Conflict Detection &amp; Resolution</text><path d="m975.8652 558.0547 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m57.543 562.0547h924.3222" stroke="#666" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.7842" x="64.543" y="557.3125">Spend(conflictingTx)</text><path d="m997.8652 591.3652h42" stroke="#666" stroke-width="2"/><path d="m1039.8652 591.3652v13" stroke="#666" stroke-width="2"/><path d="m998.8652 604.3652h41" stroke="#666" stroke-width="2"/><path d="m1008.8652 600.3652-10 4 10 4-4-4z" fill="#666" stroke="#666"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133.9609" x="1004.8652" y="586.623">Detect double-spend</text><path d="m1369.855 629.6758 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m997.8652 633.6758h377.9898" stroke="#666" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="227.0366" x="1004.8652" y="628.9336">SetConflicting(txID, conflictingTxID)</text><path d="m1396 646.6758v71h226v-61l-10-10z" fill="#fffacd" stroke="#666" stroke-width=".5"/><path d="m1612 646.6758v10h10z" fill="#fffacd" stroke="#666" stroke-width=".5"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205.207" x="1402" y="664.2441">Mark transactions as conflicting:</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133.3262" x="1402" y="679.5547">- Set ConflictingTxID</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133.1929" x="1402" y="694.8652">- Update status flags</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149.2905" x="1402" y="710.1758">- Prepare for resolution</text><path d="m1008.8652 740.2285-10 4 10 4-4-4z" fill="#666" stroke="#666"/><path d="m1002.8652 744.2285h382.9898" stroke="#666" stroke-dasharray="2 2" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.1099" x="1014.8652" y="739.4863">Conflict recorded</text><path d="m68.543 769.5391-10 4 10 4-4-4z" fill="#666" stroke="#666"/><path d="m62.543 773.5391h929.3222" stroke="#666" stroke-dasharray="2 2" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185.1929" x="74.543" y="768.7969">Error: Double spend detected</text><path d="m975.8652 798.8496 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m652.3774 802.8496h329.4878" stroke="#666" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="274.7266" x="659.3774" y="798.1074">ProcessConflictingTransactions(resolvedTx)</text><path d="m1369.855 828.1602 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m997.8652 832.1602h377.9898" stroke="#666" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.4409" x="1004.8652" y="827.418">ResolveConflict(txID)</text><path d="m1396 845.1602v71h167v-61l-10-10z" fill="#fffacd" stroke="#666" stroke-width=".5"/><path d="m1553 845.1602v10h10z" fill="#fffacd" stroke="#666" stroke-width=".5"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123.4429" x="1402" y="862.7285">Resolution process:</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.7134" x="1402" y="878.0391">- Clear ConflictingTxID</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.0449" x="1402" y="893.3496">- Update spend status</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.958" x="1402" y="908.6602">- Remove rejected tx</text><path d="m1008.8652 938.7129-10 4 10 4-4-4z" fill="#666" stroke="#666"/><path d="m1002.8652 942.7129h382.9898" stroke="#666" stroke-dasharray="2 2" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="55.9863" x="1014.8652" y="937.9707">Resolved</text><path d="m663.3774 968.0234-10 4 10 4-4-4z" fill="#666" stroke="#666"/><path d="m657.3774 972.0234h334.4878" stroke="#666" stroke-dasharray="2 2" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112.6899" x="669.3774" y="967.2813">Conflicts resolved</text><path d="m95.0859 994.0234h227.292v7.3106l-10 10h-217.292z" fill="#eee" stroke="#000" stroke-width="1.5"/><path d="m95.0859 994.0234h1100.7695v312.3477h-1100.7695z" fill="none" stroke="#000" stroke-width="1.5"/><text fill="#333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="182.292" x="110.0859" y="1007.5918">Block Mining &amp; Finalization</text><path d="m975.8652 1028.6445 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m164.8149 1032.6445h817.0503" stroke="#666" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="231.2261" x="171.8149" y="1027.9023">SetMinedMulti(txHashes[], blockInfo)</text><path d="m1002 1045.6445v86h159v-76l-10-10z" fill="#fffacd" stroke="#666" stroke-width=".5"/><path d="m1151 1045.6445v10h10z" fill="#fffacd" stroke="#666" stroke-width=".5"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134.6084" x="1008" y="1063.2129">Update mined status:</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81.8149" x="1008" y="1078.5234">- Set BlockID</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134.4243" x="1008" y="1093.834">- Record BlockHeight</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128.2227" x="1008" y="1109.1445">- Update SubtreeIdx</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138.3281" x="1008" y="1124.4551">- Clear unmined flags</text><path d="m175.8149 1154.5078-10 4 10 4-4-4z" fill="#666" stroke="#666"/><path d="m169.8149 1158.5078h822.0503" stroke="#666" stroke-dasharray="2 2" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52.8379" x="181.8149" y="1153.7656">Updated</text><path d="m975.8652 1183.8184 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m652.3774 1187.8184h329.4878" stroke="#666" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="275.0757" x="659.3774" y="1183.0762">ProcessExpiredPreservations(currentHeight)</text><path d="m1002 1200.8184v71h183v-61l-10-10z" fill="#fffacd" stroke="#666" stroke-width=".5"/><path d="m1175 1200.8184v10h10z" fill="#fffacd" stroke="#666" stroke-width=".5"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162.8555" x="1008" y="1218.3867">Cleanup old unmined txs:</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.6714" x="1008" y="1233.6973">- Check PreserveUntil</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.3618" x="1008" y="1249.0078">- Set DeleteAtHeight</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121.126" x="1008" y="1264.3184">- Schedule cleanup</text><path d="m663.3774 1294.3711-10 4 10 4-4-4z" fill="#666" stroke="#666"/><path d="m657.3774 1298.3711h334.4878" stroke="#666" stroke-dasharray="2 2" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63.0703" x="669.3774" y="1293.6289">Processed</text><path d="m599.188 1320.3711h222.4551v7.3105l-10 10h-212.4551z" fill="#eee" stroke="#000" stroke-width="1.5"/><path d="m599.188 1320.3711h684.4575v370.9688h-684.4575z" fill="none" stroke="#000" stroke-width="1.5"/><text fill="#333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="177.4551" x="614.188" y="1333.9395">Blockchain Reorganization</text><path d="m975.8652 1354.9922 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m652.3774 1358.9922h329.4878" stroke="#666" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="209.46" x="659.3774" y="1354.25">Unspend(spends[], flagAsLocked)</text><path d="m1002 1371.9922v86h204v-76l-10-10z" fill="#fffacd" stroke="#666" stroke-width=".5"/><path d="m1196 1371.9922v10h10z" fill="#fffacd" stroke="#666" stroke-width=".5"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.0288" x="1008" y="1389.5605">Revert spent UTXOs:</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.8081" x="1008" y="1404.8711">- Clear SpendingData</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116.0796" x="1008" y="1420.1816">- Mark as unspent</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183.0347" x="1008" y="1435.4922">- Optionally lock until height</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133.0215" x="1008" y="1450.8027">- Used during reorgs</text><path d="m1216.4541 1480.8555 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m997.8652 1484.8555h224.5889" stroke="#666" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.5928" x="1004.8652" y="1480.1133">Update metadata</text><path d="m1008.8652 1510.166-10 4 10 4-4-4z" fill="#666" stroke="#666"/><path d="m1002.8652 1514.166h224.5889" stroke="#666" stroke-dasharray="2 2" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52.8379" x="1014.8652" y="1509.4238">Updated</text><path d="m663.3774 1539.4766-10 4 10 4-4-4z" fill="#666" stroke="#666"/><path d="m657.3774 1543.4766h334.4878" stroke="#666" stroke-dasharray="2 2" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.8345" x="669.3774" y="1538.7344">Unspent successfully</text><path d="m975.8652 1568.7871 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m652.3774 1572.7871h329.4878" stroke="#666" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="316.4878" x="659.3774" y="1568.0449">PreserveTransactions(txIDs[], preserveUntilHeight)</text><path d="m1002 1585.7871v71h204v-61l-10-10z" fill="#fffacd" stroke="#666" stroke-width=".5"/><path d="m1196 1585.7871v10h10z" fill="#fffacd" stroke="#666" stroke-width=".5"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147.1133" x="1008" y="1603.3555">Protect during cleanup:</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161.4336" x="1008" y="1618.666">- Set PreserveUntil height</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143.749" x="1008" y="1633.9766">- Clear DeleteAtHeight</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183.1616" x="1008" y="1649.2871">- Prevent premature deletion</text><path d="m663.3774 1679.3398-10 4 10 4-4-4z" fill="#666" stroke="#666"/><path d="m657.3774 1683.3398h334.4878" stroke="#666" stroke-dasharray="2 2" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61.0898" x="669.3774" y="1678.5977">Preserved</text><path d="m695.5669 1705.3398h257.7988v7.3106l-10 10h-247.7988z" fill="#eee" stroke="#000" stroke-width="1.5"/><path d="m695.5669 1705.3398h532.8872v396.9688h-532.8872z" fill="none" stroke="#000" stroke-width="1.5"/><text fill="#333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="212.7988" x="710.5669" y="1718.9082">Alert System - Freeze/Unfreeze</text><path d="m975.8652 1739.9609 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m736.2329 1743.9609h245.6323" stroke="#666" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151.5376" x="743.2329" y="1739.2188">FreezeUTXOs(utxoList[])</text><path d="m1002 1756.9609v86h183v-76l-10-10z" fill="#fffacd" stroke="#666" stroke-width=".5"/><path d="m1175 1756.9609v10h10z" fill="#fffacd" stroke="#666" stroke-width=".5"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162.2588" x="1008" y="1774.5293">Freeze suspicious UTXOs:</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105.8091" x="1008" y="1789.8398">- Mark as frozen</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.6309" x="1008" y="1805.1504">- Prevent spending</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.5854" x="1008" y="1820.4609">- Log freeze reason</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117.5269" x="1008" y="1835.7715">- Alert compliance</text><path d="m997.8652 1869.8242h42" stroke="#666" stroke-width="2"/><path d="m1039.8652 1869.8242v13" stroke="#666" stroke-width="2"/><path d="m998.8652 1882.8242h41" stroke="#666" stroke-width="2"/><path d="m1008.8652 1878.8242-10 4 10 4-4-4z" fill="#666" stroke="#666"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182.9775" x="1004.8652" y="1865.082">UpdateFreezeStatus(FROZEN)</text><path d="m747.2329 1908.1348-10 4 10 4-4-4z" fill="#666" stroke="#666"/><path d="m741.2329 1912.1348h250.6323" stroke="#666" stroke-dasharray="2 2" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.7925" x="753.2329" y="1907.3926">Frozen count</text><path d="m975.8652 1937.4453 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m736.2329 1941.4453h245.6323" stroke="#666" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166.4229" x="743.2329" y="1936.7031">UnfreezeUTXOs(utxoList[])</text><path d="m1002 1954.4453v71h177v-61l-10-10z" fill="#fffacd" stroke="#666" stroke-width=".5"/><path d="m1169 1954.4453v10h10z" fill="#fffacd" stroke="#666" stroke-width=".5"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156.3682" x="1008" y="1972.0137">Unfreeze cleared UTXOs:</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.52" x="1008" y="1987.3242">- Remove freeze flag</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108.4688" x="1008" y="2002.6348">- Allow spending</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.4438" x="1008" y="2017.9453">- Log unfreeze event</text><path d="m997.8652 2051.998h42" stroke="#666" stroke-width="2"/><path d="m1039.8652 2051.998v13" stroke="#666" stroke-width="2"/><path d="m998.8652 2064.998h41" stroke="#666" stroke-width="2"/><path d="m1008.8652 2060.998-10 4 10 4-4-4z" fill="#666" stroke="#666"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201.5889" x="1004.8652" y="2047.2559">UpdateFreezeStatus(UNFROZEN)</text><path d="m747.2329 2090.3086-10 4 10 4-4-4z" fill="#666" stroke="#666"/><path d="m741.2329 2094.3086h250.6323" stroke="#666" stroke-dasharray="2 2" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97.6777" x="753.2329" y="2089.5664">Unfrozen count</text><path d="m10 2116.3086h163.8091v7.3105l-10 10h-153.8091z" fill="#eee" stroke="#000" stroke-width="1.5"/><path d="m10 2116.3086h1182.8149v521.5215h-1182.8149z" fill="none" stroke="#000" stroke-width="1.5"/><text fill="#333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="118.8091" x="25" y="2129.877">Query Operations</text><path d="m975.8652 2150.9297 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m57.543 2154.9297h924.3222" stroke="#666" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.9326" x="64.543" y="2150.1875">GetSpend(spend)</text><path d="m997.8652 2184.2402h42" stroke="#666" stroke-width="2"/><path d="m1039.8652 2184.2402v13" stroke="#666" stroke-width="2"/><path d="m998.8652 2197.2402h41" stroke="#666" stroke-width="2"/><path d="m1008.8652 2193.2402-10 4 10 4-4-4z" fill="#666" stroke="#666"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.3281" x="1004.8652" y="2179.498">Lookup UTXO</text><path d="m1002 2210.2402v71h171v-61l-10-10z" fill="#fffacd" stroke="#666" stroke-width=".5"/><path d="m1163 2210.2402v10h10z" fill="#fffacd" stroke="#666" stroke-width=".5"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127.4292" x="1008" y="2227.8086">Check spend status:</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84.4175" x="1008" y="2243.1191">- Status code</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150.9473" x="1008" y="2258.4297">- SpendingData if spent</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.3555" x="1008" y="2273.7402">- LockTime if locked</text><path d="m68.543 2303.793-10 4 10 4-4-4z" fill="#666" stroke="#666"/><path d="m62.543 2307.793h929.3222" stroke="#666" stroke-dasharray="2 2" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98.8711" x="74.543" y="2303.0508">SpendResponse</text><path d="m975.8652 2333.1035 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m652.3774 2337.1035h329.4878" stroke="#666" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149.1255" x="659.3774" y="2332.3613">GetUnminedTxIterator()</text><path d="m1002 2350.1035v71h152v-61l-10-10z" fill="#fffacd" stroke="#666" stroke-width=".5"/><path d="m1144 2350.1035v10h10z" fill="#fffacd" stroke="#666" stroke-width=".5"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.0664" x="1008" y="2367.6719">Stream unmined txs:</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.1177" x="1008" y="2382.9824">- Create iterator</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118.5679" x="1008" y="2398.293">- Batch processing</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117.5713" x="1008" y="2413.6035">- Memory efficient</text><path d="m663.3774 2443.6563-10 4 10 4-4-4z" fill="#666" stroke="#666"/><path d="m657.3774 2447.6563h334.4878" stroke="#666" stroke-dasharray="2 2" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119.1709" x="669.3774" y="2442.9141">UnminedTxIterator</text><path d="m975.8652 2472.9668 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m652.3774 2476.9668h329.4878" stroke="#666" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="283.7529" x="659.3774" y="2472.2246">QueryOldUnminedTransactions(cutoffHeight)</text><path d="m997.8652 2506.2773h42" stroke="#666" stroke-width="2"/><path d="m1039.8652 2506.2773v13" stroke="#666" stroke-width="2"/><path d="m998.8652 2519.2773h41" stroke="#666" stroke-width="2"/><path d="m1008.8652 2515.2773-10 4 10 4-4-4z" fill="#666" stroke="#666"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.2148" x="1004.8652" y="2501.5352">Filter by height</text><path d="m1002 2532.2773v71h180v-61l-10-10z" fill="#fffacd" stroke="#666" stroke-width=".5"/><path d="m1172 2532.2773v10h10z" fill="#fffacd" stroke="#666" stroke-width=".5"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.0845" x="1008" y="2549.8457">Find stale unmined txs:</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159.8149" x="1008" y="2565.1563">- Compare against cutoff</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118.2886" x="1008" y="2580.4668">- Return tx hashes</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134.7734" x="1008" y="2595.7773">- Prepare for cleanup</text><path d="m663.3774 2625.8301-10 4 10 4-4-4z" fill="#666" stroke="#666"/><path d="m657.3774 2629.8301h334.4878" stroke="#666" stroke-dasharray="2 2" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.6689" x="669.3774" y="2625.0879">[]chainhash.Hash</text><path d="m10 2651.8301h160.0132v7.3105l-10 10h-150.0132z" fill="#eee" stroke="#000" stroke-width="1.5"/><path d="m10 2651.8301h1283.6455v247.1055h-1283.6455z" fill="none" stroke="#000" stroke-width="1.5"/><text fill="#333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="115.0132" x="25" y="2665.3984">Batch Operations</text><path d="m975.8652 2686.4512 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m57.543 2690.4512h924.3222" stroke="#666" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205.5625" x="64.543" y="2685.709">BatchDecorate(unresolvedData[])</text><path d="m1002 2703.4512v71h179v-61l-10-10z" fill="#fffacd" stroke="#666" stroke-width=".5"/><path d="m1171 2703.4512v10h10z" fill="#fffacd" stroke="#666" stroke-width=".5"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155.854" x="1008" y="2721.0195">Fetch metadata in batch:</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.7017" x="1008" y="2736.3301">- Parallel processing</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137.6172" x="1008" y="2751.6406">- Specified fields only</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158.8945" x="1008" y="2766.9512">- Error handling per item</text><path d="m924.8188 2786.6934h74.4468v7.3105l-10 10h-64.4468z" fill="#eee" stroke="#000" stroke-width="1.5"/><path d="m924.8188 2786.6934h358.8267v75.9316h-358.8267z" fill="none" stroke="#000" stroke-width="1.5"/><text fill="#333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.4468" x="939.8188" y="2800.2617">loop</text><text fill="#333" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="151.4863" x="1014.2656" y="2799.3281">[For each unresolved item]</text><path d="m1216.4541 2821.3145 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m997.8652 2825.3145h224.5889" stroke="#666" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102.4702" x="1004.8652" y="2820.5723">Get(hash, fields)</text><path d="m1008.8652 2850.625-10 4 10 4-4-4z" fill="#666" stroke="#666"/><path d="m1002.8652 2854.625h224.5889" stroke="#666" stroke-dasharray="2 2" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.4922" x="1014.8652" y="2849.8828">meta.Data</text><path d="m68.543 2886.9355-10 4 10 4-4-4z" fill="#666" stroke="#666"/><path d="m62.543 2890.9355h929.3222" stroke="#666" stroke-dasharray="2 2" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.0269" x="74.543" y="2886.1934">Decorated results</text><path d="m95.0859 2912.9355h246.5064v7.3106l-10 10h-236.5064z" fill="#eee" stroke="#000" stroke-width="1.5"/><path d="m95.0859 2912.9355h1416.4912v1041.043h-1416.4912z" fill="none" stroke="#000" stroke-width="1.5"/><text fill="#333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="201.5063" x="110.0859" y="2926.5039">Subtree Validation Operations</text><path d="m975.8652 2947.5566 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m374.8203 2951.5566h607.0449" stroke="#666" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.1294" x="381.8203" y="2946.8145">Create(tx, blockHeight)</text><path d="m1002 2964.5566v71h209v-61l-10-10z" fill="#fffacd" stroke="#666" stroke-width=".5"/><path d="m1201 2964.5566v10h10z" fill="#fffacd" stroke="#666" stroke-width=".5"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188.5889" x="1008" y="2982.125">Create UTXOs for subtree txs:</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.335" x="1008" y="2997.4355">- Store output scripts</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116.0796" x="1008" y="3012.7461">- Mark as unspent</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.6089" x="1008" y="3028.0566">- Link to subtree</text><path d="m385.8203 3058.1094-10 4 10 4-4-4z" fill="#666" stroke="#666"/><path d="m379.8203 3062.1094h612.0449" stroke="#666" stroke-dasharray="2 2" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.4922" x="391.8203" y="3057.3672">meta.Data</text><path d="m975.8652 3087.4199 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m374.8203 3091.4199h607.0449" stroke="#666" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.5151" x="381.8203" y="3086.6777">BatchDecorate(txHashes[])</text><path d="m1002 3104.4199v71h212v-61l-10-10z" fill="#fffacd" stroke="#666" stroke-width=".5"/><path d="m1204 3104.4199v10h10z" fill="#fffacd" stroke="#666" stroke-width=".5"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191.5215" x="1008" y="3121.9883">Retrieve metadata for subtree:</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112.6709" x="1008" y="3137.2988">- Parallel fetching</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133.8784" x="1008" y="3152.6094">- Cache optimization</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.6494" x="1008" y="3167.9199">- Error aggregation</text><path d="m1216.4541 3197.9727 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m997.8652 3201.9727h224.5889" stroke="#666" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.9702" x="1004.8652" y="3197.2305">Batch fetch</text><path d="m1008.8652 3227.2832-10 4 10 4-4-4z" fill="#666" stroke="#666"/><path d="m1002.8652 3231.2832h224.5889" stroke="#666" stroke-dasharray="2 2" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.7319" x="1014.8652" y="3226.541">Metadata collection</text><path d="m385.8203 3256.5938-10 4 10 4-4-4z" fill="#666" stroke="#666"/><path d="m379.8203 3260.5938h612.0449" stroke="#666" stroke-dasharray="2 2" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144.2949" x="391.8203" y="3255.8516">Decorated tx metadata</text><path d="m1295.4478 3285.9043 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m374.8203 3289.9043h926.6275" stroke="#666" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.2866" x="381.8203" y="3285.1621">StoreSubtree(subtreeData)</text><path d="m1322 3302.9043v71h179v-61l-10-10z" fill="#fffacd" stroke="#666" stroke-width=".5"/><path d="m1491 3302.9043v10h10z" fill="#fffacd" stroke="#666" stroke-width=".5"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158.5771" x="1328" y="3320.4727">Persist validated subtree:</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.8223" x="1328" y="3335.7832">- Store merkle proof</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119.2979" x="1328" y="3351.0938">- Link transactions</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155.7017" x="1328" y="3366.4043">- Record validation state</text><path d="m385.8203 3396.457-10 4 10 4-4-4z" fill="#666" stroke="#666"/><path d="m379.8203 3400.457h931.6275" stroke="#666" stroke-dasharray="2 2" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92.2505" x="391.8203" y="3395.7148">Subtree stored</text><path d="m357.8203 3425.7676 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m164.8149 3429.7676h199.0054" stroke="#666" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186.0054" x="171.8149" y="3425.0254">ValidateSubtree(subtreeHash)</text><path d="m1300.4478 3455.0781 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m379.8203 3459.0781h926.6275" stroke="#666" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.8149" x="386.8203" y="3454.3359">GetSubtree(hash)</text><path d="m390.8203 3484.3887-10 4 10 4-4-4z" fill="#666" stroke="#666"/><path d="m384.8203 3488.3887h926.6275" stroke="#666" stroke-dasharray="2 2" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79.4346" x="396.8203" y="3483.6465">Subtree data</text><path d="m975.8652 3513.6992 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m379.8203 3517.6992h602.0449" stroke="#666" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.2207" x="386.8203" y="3512.957">ValidateUTXOs(txList)</text><path d="m1002 3530.6992v71h203v-61l-10-10z" fill="#fffacd" stroke="#666" stroke-width=".5"/><path d="m1195 3530.6992v10h10z" fill="#fffacd" stroke="#666" stroke-width=".5"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="152.6357" x="1008" y="3548.2676">Validate subtree UTXOs:</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147.2593" x="1008" y="3563.5781">- Check all inputs exist</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.501" x="1008" y="3578.8887">- Verify spending rules</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182.8252" x="1008" y="3594.1992">- Confirm no double-spends</text><path d="m390.8203 3624.252-10 4 10 4-4-4z" fill="#666" stroke="#666"/><path d="m384.8203 3628.252h607.0449" stroke="#666" stroke-dasharray="2 2" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.8462" x="396.8203" y="3623.5098">Validation results</text><path d="m175.8149 3653.5625-10 4 10 4-4-4z" fill="#666" stroke="#666"/><path d="m169.8149 3657.5625h204.0054" stroke="#666" stroke-dasharray="2 2" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81.6372" x="181.8149" y="3652.8203">Subtree valid</text><path d="m390.8203 3682.873-10 4 10 4-4-4z" fill="#666" stroke="#666"/><path d="m384.8203 3686.873h266.5571" stroke="#666" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="253.5571" x="396.8203" y="3682.1309">CheckBlockSubtrees(blockID, subtrees[])</text><path d="m202 3699.873v71h161v-61l-10-10z" fill="#fffacd" stroke="#666" stroke-width=".5"/><path d="m353 3699.873v10h10z" fill="#fffacd" stroke="#666" stroke-width=".5"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137.084" x="208" y="3717.4414">Verify block subtrees:</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133.9038" x="208" y="3732.752">- Match merkle roots</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139.3882" x="208" y="3748.0625">- Validate all subtrees</text><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140.9434" x="208" y="3763.373">- Check completeness</text><path d="m295.7568 3783.1152h74.4468v7.3106l-10 10h-64.4468z" fill="#eee" stroke="#000" stroke-width="1.5"/><path d="m295.7568 3783.1152h1055.4932v134.5527h-1055.4932z" fill="none" stroke="#000" stroke-width="1.5"/><text fill="#333" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.4468" x="310.7568" y="3796.6836">loop</text><text fill="#333" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="102.8188" x="385.2036" y="3795.75">[For each subtree]</text><path d="m980.8652 3817.7363 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m379.8203 3821.7363h607.0449" stroke="#666" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.6216" x="386.8203" y="3816.9941">GetSpends(subtreeTxs)</text><path d="m390.8203 3847.0469-10 4 10 4-4-4z" fill="#666" stroke="#666"/><path d="m384.8203 3851.0469h607.0449" stroke="#666" stroke-dasharray="2 2" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94.8848" x="396.8203" y="3846.3047">Spend statuses</text><path d="m1300.4478 3876.3574 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m379.8203 3880.3574h926.6275" stroke="#666" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.7065" x="386.8203" y="3875.6152">VerifySubtree(hash)</text><path d="m390.8203 3905.668-10 4 10 4-4-4z" fill="#666" stroke="#666"/><path d="m384.8203 3909.668h926.6275" stroke="#666" stroke-dasharray="2 2" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.8584" x="396.8203" y="3904.9258">Verification result</text><path d="m640.3774 3941.9785 10 4-10 4 4-4z" fill="#666" stroke="#666"/><path d="m374.8203 3945.9785h271.5571" stroke="#666" stroke-dasharray="2 2" stroke-width="2"/><text fill="#333" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125.4805" x="381.8203" y="3941.2363">Block subtrees valid</text><text fill="#333" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="149.9023" x="745.6523" y="4059.623">Generated: 2025-08-26 13:32</text></svg>
