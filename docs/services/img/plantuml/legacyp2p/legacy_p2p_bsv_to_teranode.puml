@startuml overview


participant MainNet as mainnet
participant "P2P Legacy\nOverlay Service" as legacy
database db
participant "Teranode" as teranode

legacy -> mainnet: connect

mainnet -> legacy : OnInv(peer, msg)

legacy -> db: have I seen this block before?
return no

legacy -> mainnet: OnGetData(peer, msg)


mainnet -> legacy : OnBlock(peer, msg, bytes)

legacy -> legacy: build subtree and block

legacy -> teranode: BlockFound(ctx, hash, base_url)

teranode -> legacy: http://{base_url}/block/hash

legacy --> teranode: block

teranode -> legacy: http://{base_url}/subtree/hash

legacy --> teranode: subtree


loop each txid
    teranode -> legacy: http://{base_url}/tx/txid
    legacy -> teranode: tx(response)
end

left footer "Last Modified On: 26-March-2024. Â© 2024 Bitcoin SV. All rights reserved."

@enduml
