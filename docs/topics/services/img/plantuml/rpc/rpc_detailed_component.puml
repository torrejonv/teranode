skinparam defaultTextAlignment center
skinparam rectangle {
  BackgroundColor #e6f0ff
  BorderColor #3366cc
  FontColor black
  RoundCorner 10
}
skinparam component {
  BackgroundColor #e6f0ff
  BorderColor #3366cc
  FontColor black
  RoundCorner 10
}
skinparam database {
  BackgroundColor #f2f2f2
  BorderColor #999999
  FontColor black
  RoundCorner 10
}
skinparam shadowing false
skinparam ArrowColor #666666

@startuml RPC_Component

!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Component.puml

title RPC Service - Component Diagram (Code-Verified Connections)

Container_Boundary(rpc_service, "RPC Service") {

Component(rpc_server, "RPC Server", "Go", "HTTP server with JSON-RPC handler routing commands to handler functions")

Component(blockchain_client, "Blockchain Client", "Go gRPC", "Interface to Blockchain service")

Component(block_assembly_client, "Block Assembly Client", "Go gRPC", "Interface to Block Assembly service")

Component(p2p_client, "P2P Client", "Go gRPC", "Interface to P2P service")

Component(legacy_peer_client, "Legacy Peer Client", "Go gRPC", "Interface to Legacy Peer service")

Component(propagation_client, "Propagation Client", "Go gRPC", "Interface to Propagation service")

Component(utxo_store_client, "UTXO Store Client", "Go", "Interface to UTXO database")

Component(asset_http_client, "Asset HTTP Client", "Go HTTP", "Interface to Asset Server for hex data")

}

Container_Boundary(external_services, "External Services") {

Container(blockchain, "Blockchain Service", "Go", "Blockchain state management")

Container(block_assembly, "Block Assembly Service", "Go", "Block creation and mining")

Container(p2p_service, "P2P Service", "Go", "P2P network management")

Container(legacy_peer, "Legacy Peer Service", "Go", "Legacy peer management")

Container(propagation, "Propagation Service", "Go", "Transaction propagation to network")

Container(asset_server, "Asset Server", "Go", "Static asset serving and transaction hex API")

ContainerDb(utxo_store, "UTXO Store", "Database", "UTXO database")

}

Person(external_user, "External User", "Bitcoin application developer, miner, or node operator")

Person(admin, "Administrator", "Node operator")

' External API interactions

Rel(external_user, rpc_server, "JSON-RPC requests", "HTTP")

Rel(admin, rpc_server, "Administrative requests", "HTTP")

' RPC Server to service client interactions

Rel(rpc_server, blockchain_client, "Blockchain and admin operations")

Rel(rpc_server, block_assembly_client, "Mining operations")

Rel(rpc_server, propagation_client, "Submit transactions")

Rel(rpc_server, p2p_client, "P2P operations")

Rel(rpc_server, legacy_peer_client, "Legacy peer operations")

Rel(rpc_server, utxo_store_client, "UTXO queries and operations")

Rel(rpc_server, asset_http_client, "Transaction hex data")

' Service client connections (CODE-VERIFIED)

Rel(blockchain_client, blockchain, "gRPC calls", "gRPC")

Rel(block_assembly_client, block_assembly, "gRPC calls", "gRPC")

Rel(p2p_client, p2p_service, "gRPC calls", "gRPC")

Rel(legacy_peer_client, legacy_peer, "gRPC calls", "gRPC")

Rel(propagation_client, propagation, "gRPC calls", "gRPC")

Rel(utxo_store_client, utxo_store, "Database queries", "Direct")

Rel(asset_http_client, asset_server, "HTTP requests", "HTTP")


SHOW_LEGEND()

@enduml
